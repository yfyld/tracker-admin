{"version":3,"sources":["components/Filter.tsx","components/Indicator.module.less","components/Indicator.tsx","components/Filter.module.less","pages/analyse/components/AnalyseHeader.module.less","components/ReportAppendBoard.tsx","pages/analyse/components/AnalyseHeader.tsx","components/Dimension.tsx","components/Dimension.module.less","pages/analyse/AnalyseFunnel.module.less","pages/analyse/AnalyseFunnel.tsx"],"names":["Option","Select","OptGroup","Filter","fieldList","list","EVENT_ATTRS","filterInfo","onChange","React","recommend","setrecommend","handleFieldChange","value","index","newFilterInfo","JSON","parse","stringify","filterValues","key","type","field","find","handleFilterTypeChange","handleFilterValueChange","length","className","style","wrapper","size","onClick","filterType","line","form","map","filter","gutter","id","span","val","name","mode","width","tokenSeparators","item","dataSource","splice","handleClose","close","push","uuidv4","add","module","exports","Search","Input","connect","state","metadata","activeMetadataList","activeMetadataListParams","tagList","fieldListMap","dispatch","bindActionCreators","onGetActiveMetadataList","param","doGetActiveMetadataList","request","onGetFieldList","doGetFieldList","indicators","hasType","addText","hasCustomName","metadataparam","setmetadataparam","handleSelectMetadata","info","newIndicators","metadataCode","code","metadataName","projectId","handleFilterChange","handleTypeChange","handleSearch","allMetadata","indicatorInfo","center","color","overlay","content","e","stopPropagation","placeholder","target","onSearch","tags","split","Number","join","metadataBox","active","readOnly","select","defaultValue","customName","onBlur","event","handleNameChange","handleRemove","boardList","board","onAppendReportToBoard","params","doAppendReportToBoard","reportInfo","children","appendedBoardIds","setappendedBoardIds","placement","trigger","onVisibleChange","isExist","boards","disabled","record","reportId","boardIds","message","title","report","onAddReport","doAddReport","onUpdateReport","doUpdateReport","data","useState","newReportInfo","setnewReportInfo","useEffect","btns","icon","newInfo","description","Dimension","dimension","Group","Collapse","Panel","project","projectInfo","analyse","funnelAnalyseData","funnelAnalyseParam","analyseLoading","onGetFunnelAnalyseData","doGetFunnelAnalyse","handleChange","rule","ruleSection","ruleTitle","indicatorType","preview","time","dateType","dateEnd","dateStart","offset","compact","spinning"],"mappings":"sOAQQA,EAAqBC,IAArBD,OAAqBC,IAAbC,SA6JDC,IArJA,SAAC,GAAwE,IAAD,IAArEC,iBAAqE,MAAzD,CAAEC,KAAMC,KAAiD,EAAlCC,EAAkC,EAAlCA,WAAYC,EAAsB,EAAtBA,SAAsB,EACnDC,WAAyB,IAD0B,mBAC9EC,EAD8E,KACnEC,EADmE,KAE/EC,EAAoB,SAACC,EAAeC,GACxC,IAAMC,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAcI,aAAaL,GAAOM,IAAMP,EACxCE,EAAcI,aAAaL,GAAOO,KAAO,QACzCN,EAAcI,aAAaL,GAAOD,MAAQ,GAC1C,IAAMS,EAAQlB,EAAUC,KAAKkB,MAAK,SAAAD,GAAK,OAAIA,EAAMT,QAAUA,KACvDS,GACFX,EAAaW,EAAMZ,WAGrBF,EAASO,IAGLS,EAAyB,SAACX,EAAeC,GAC7C,IAAMC,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAcI,aAAaL,GAAOO,KAAOR,EAEvCE,EAAcI,aAAaL,GAAOD,MADtB,UAAVA,GAA+B,aAAVA,EACmB,GACvB,YAAVA,EACiC,CAAC,KAAM,MAEP,KAE5CL,EAASO,IAGLU,EAA0B,SAACZ,EAAeC,GAC9C,IAAMC,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAcI,aAAaL,GAAOD,MAAQA,EAC1CL,EAASO,IA0BX,OACE,2BACGR,EAAWY,aAAaO,OAAS,GAChC,uBAAKC,UAAWC,IAAMC,SACnBtB,EAAWY,aAAaO,OAAS,GAChC,uBAAKC,UAAWC,IAAMP,MACpB,gBAAC,IAAD,CAAQS,KAAK,QAAQC,QAZF,WAC7B,IAAMhB,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAciB,WAA0C,QAA7BjB,EAAciB,WAAuB,KAAO,MACvExB,EAASO,KAU8B,QAA1BR,EAAWyB,WAAuB,SAAM,UAE3C,uBAAKL,UAAWC,IAAMK,QAG1B,uBAAKN,UAAWC,IAAMM,MACnB3B,EAAWY,aAAagB,KAAI,SAACC,EAAQtB,GAAT,OAC3B,gBAAC,IAAD,CAAKuB,OAAQ,GAAIjB,IAAKgB,EAAOE,IAC3B,gBAAC,IAAD,CAAKC,KAAM,GACT,gBAAC,IAAD,CAAQ1B,MAAOuB,EAAOhB,IAAKZ,SAAU,SAACgC,GAAD,OAAiB5B,EAAkB4B,EAAK1B,KAC1EV,EAAUC,KAAK8B,KAAI,SAAAb,GAAK,OACvB,gBAACtB,EAAD,CAAQa,MAAOS,EAAMT,MAAOO,IAAKE,EAAMT,OACpCS,EAAMmB,WAKf,gBAAC,IAAD,CAAKF,KAAM,GACT,gBAAC,IAAD,CAAQ1B,MAAOuB,EAAOf,KAAMb,SAAU,SAACgC,GAAD,OAAiBhB,EAAuBgB,EAAK1B,KACjF,gBAACd,EAAD,CAAQa,MAAM,SAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,YAAd,sBACA,gBAACb,EAAD,CAAQa,MAAM,SAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,UAAd,gBAEA,gBAACb,EAAD,CAAQa,MAAM,WAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,QAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,WAAd,gBAEA,gBAACb,EAAD,CAAQa,MAAM,WAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,cAAd,sBACA,gBAACb,EAAD,CAAQa,MAAM,WAAd,gBACA,gBAACb,EAAD,CAAQa,MAAM,cAAd,sBACA,gBAACb,EAAD,CAAQa,MAAM,SAAd,4BACA,gBAACb,EAAD,CAAQa,MAAM,YAAd,oCAGa,YAAhBuB,EAAOf,MACU,eAAhBe,EAAOf,MACS,UAAhBe,EAAOf,MACS,WAAhBe,EAAOf,MACS,UAAhBe,EAAOf,MACS,aAAhBe,EAAOf,MACL,gBAAC,IAAD,CAAKkB,KAAM,GACQ,UAAhBH,EAAOf,MAAoC,aAAhBe,EAAOf,KACjC,gBAAC,IAAD,CACER,MAAOuB,EAAOvB,MACdL,SAAU,SAACgC,GAAD,OAAiBf,EAAwBe,EAAK1B,IACxD4B,KAAK,OACLd,MAAO,CAAEe,MAAO,QAChBC,gBAAiB,CAAC,MAEjBlC,EAAUyB,KAAI,SAAAU,GAAI,OACjB,gBAAC7C,EAAD,CAAQoB,IAAKyB,EAAMhC,MAAOgC,GACvBA,OAKP,gBAAC,IAAD,CACEhC,MAAOuB,EAAOvB,MACdiC,WAAYpC,EACZkB,MAAO,CAAEe,MAAO,QAChBnC,SAAU,SAACgC,GAAD,OAAcf,EAAwBe,EAAK1B,OAK/D,gBAAC,IAAD,CAAKyB,KAAM,GACT,uBAAKR,QAAS,kBAlGV,SAACjB,GACnB,IAAMC,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAcI,aAAa4B,OAAOjC,EAAO,GACzCN,EAASO,GA+FyBiC,CAAYlC,IAAQa,UAAW,YAAcC,IAAMqB,OACrE,gBAAC,IAAD,CAAM5B,KAAK,yBAQzB,qBAAGU,QArGW,WAChB,IAAMhB,EAA6BC,KAAKC,MAAMD,KAAKE,UAAUX,IAC7DQ,EAAcI,aAAa+B,KAAK,CAC9B7B,KAAM,KACND,IAAK,KACLP,MAAO,KACPyB,GAAIa,gBAEN3C,EAASO,IA6FgBY,UAAWC,IAAMwB,KACtC,gBAAC,IAAD,CAAM/B,KAAK,gBADb,+B,qBC5JNgC,EAAOC,QAAU,CAAC,QAAU,2BAA2B,OAAS,0BAA0B,QAAU,2BAA2B,OAAS,0BAA0B,YAAc,+BAA+B,OAAS,0BAA0B,OAAS,4B,iwBCoBnPtD,EAAqBC,IAArBD,OAEAuD,GAFqBtD,IAAbC,SAEGsD,IAAXD,QAyOOE,iBApBS,SAACC,GAAwB,IAAD,EACkCA,EAAMC,SACtF,MAAO,CACLC,mBAH4C,EACtCA,mBAGNC,yBAJ4C,EAClBA,yBAI1BC,QAL4C,EACQA,QAKpDC,aAN4C,EACiBA,iBAStC,SAACC,GAAD,OACzBC,YACE,CACEC,wBAAyB,SAAAC,GAAK,OAAIC,IAAwBC,QAAQF,IAClEG,eAAgB,SAAAH,GAAK,OAAII,IAAeF,QAAQF,KAGlDH,KAGWP,EAvNG,SAAC,GAaL,IAZZe,EAYW,EAZXA,WACAZ,EAWW,EAXXA,mBACAC,EAUW,EAVXA,yBACArD,EASW,EATXA,SACAuD,EAQW,EARXA,aACAU,EAOW,EAPXA,QAOW,IANXC,eAMW,MAND,4BAMC,MALXC,qBAKW,aAJXtD,YAIW,MAJJ,KAII,EAHXyC,EAGW,EAHXA,QACAI,EAEW,EAFXA,wBACAI,EACW,EADXA,eACW,EAC+B7D,WAAA,KAAoBoD,IADnD,mBACJe,EADI,KACWC,EADX,KAMX,SAASC,EAAqBC,EAAqBjE,GACjD,IAAMkE,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAclE,GAAOmE,aAAeF,EAAKG,KACzCF,EAAclE,GAAOqE,aAAeJ,EAAKtC,KACzCjC,EAASwE,EAAeR,EAAW1D,IACnCwD,EAAe,CAAEc,UAAWL,EAAKK,UAAWH,aAAcF,EAAKG,OAGjE,SAASG,EAAmBN,EAAmBjE,GAC7C,IAAMkE,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAclE,GAAOsB,OAAS2C,EAC9BvE,EAASwE,GAGX,SAASM,EAAiBzE,EAAeC,GACvC,IAAMkE,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAclE,GAAOO,KAAOR,EAC5BL,EAASwE,GA8BX,SAASO,EAAapB,GACpBD,EAAwBC,GApD1B1D,aAAgB,WACdoE,EAAiBhB,KAChB,CAACA,IAqDJ,IAAM2B,EAAc,CAClB/C,KAAM,2BACNyC,KAAM,iBAGR,OACE,uBAAKvD,UAAWC,IAAMC,SACpB,2BACG2C,EAAWrC,KAAI,SAACsD,EAAe3E,GAAhB,OACd,uBAAKM,IAAKqE,EAAcnD,IACtB,gBAAC,IAAD,CAAKX,UAAWC,IAAMiB,KAAMR,OAAQ,IAClC,gBAAC,IAAD,CAAKE,KAAM,GACT,uBAAKZ,UAAWC,IAAM8D,QACpB,gBAAC,IAAD,CAAKC,MAAM,QAAQ7E,EAAQ,KAG/B,gBAAC,IAAD,CAAKyB,KAAM,GACT,gBAAC,IAAD,CACEqD,QACE,uBAAKjE,UAAWC,IAAMiE,SACpB,uBAAK9D,QAAS,SAAA+D,GAAC,OAAIA,EAAEC,oBACnB,gBAACxC,EAAD,CACEyC,YAAY,2BACZnF,MAAO+D,EAAcnC,KACrBjC,SAAU,SAAAsF,GAAC,OAAIjB,EAAiB,EAAD,GAAMD,EAAN,CAAqBnC,KAAMqD,EAAEG,OAAOpF,UACnEqF,SAAU,SAAAzD,GAAI,OAAI8C,EAAa,EAAD,GAAMX,EAAN,CAAqBnC,WACnDb,MAAO,CAAEe,MAAO,OANpB,OASE,gBAAC,IAAD,CACEqD,YAAY,uCACZpE,MAAO,CAAEe,MAAO,KAChBD,KAAK,WACL7B,MAAO+D,EAAcuB,KAAOvB,EAAcuB,KAAKC,MAAM,KAAKjE,KAAI,SAAAU,GAAI,OAAIwD,OAAOxD,MAAS,GACtFrC,SAAU,SAAC2F,GAAD,OAAoBZ,EAAa,EAAD,GAAMX,EAAN,CAAqBuB,KAAMA,EAAKG,KAAK,UAE9ExC,EAAQzD,KAAK8B,KAAI,SAAAU,GAAI,OACpB,gBAAC7C,EAAD,CAAQoB,IAAKyB,EAAKP,GAAIzB,MAAOgC,EAAKP,IAC/BO,EAAKJ,WAMd,uBAAKd,UAAWC,IAAM2E,aACpB,wBACExE,QAAS,kBAAM+C,EAAqBU,EAAa1E,IACjDa,UAAW6D,EAAYN,OAASO,EAAcR,aAAerD,IAAM4E,OAAS,GAC5EpF,IAAKoE,EAAYN,MAHnB,4BAQCtB,EAAmBvD,KACjB+B,QAAO,SAAAS,GACN,OAAKxB,GAGEwB,EAAKxB,OAASA,KAEtBc,KAAI,SAAAU,GAAI,OACP,wBACEd,QAAS,kBAAM+C,EAAqBjC,EAAM/B,IAC1Ca,UAAWkB,EAAKqC,OAASO,EAAcR,aAAerD,IAAM4E,OAAS,GACrEpF,IAAKyB,EAAKqC,MAETrC,EAAKJ,YAOlB,gBAAC,IAAD,CAAO5B,MAAO4E,EAAcN,aAAcsB,UAAQ,EAAC9E,UAAWC,IAAM8E,WAGvE/B,GACC,gBAAC,IAAD,CAAKpC,KAAM,GACT,gBAAC,IAAD,CACEoE,aAAclB,EAAcmB,WAC5BZ,YAAY,iCACZa,OAAQ,SAAAC,GAAK,OAhH/B,SAA0BjG,EAAeC,GACvC,IAAMkE,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAclE,GAAO8F,WAAa/F,EAClCL,EAASwE,GA6GwB+B,CAAiBD,EAAMb,OAAOpF,MAAOC,OAI3D2D,GACC,gCACE,gBAAC,IAAD,CAAKlC,KAAM,GACT,uBAAKZ,UAAWC,IAAM8D,QAAtB,WAEF,gBAAC,IAAD,CAAKnD,KAAM,GACT,gBAAC,IAAD,CAAQ/B,SAAU,SAACgC,GAAD,OAAiB8C,EAAiB9C,EAAK1B,IAAQD,MAAO4E,EAAcpE,MACpF,gBAACrB,EAAD,CAAQa,MAAM,MAAd,sBACA,gBAACb,EAAD,CAAQa,MAAM,MAAd,sBACA,gBAACb,EAAD,CAAQa,MAAM,OAAd,4BACA,gBAACb,EAAD,CAAQa,MAAM,OAAd,4BACA,gBAACb,EAAD,CAAQa,MAAM,OAAd,qCAMP2D,EAAW9C,OAAS,GACnB,gBAAC,IAAD,CAAKa,KAAM,GACT,uBAAKR,QAAS,kBAlH9B,SAAsBjB,GACpB,IAAMkE,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAcjC,OAAOjC,EAAO,GAC5BN,EAASwE,EAAeR,EAAW1D,IA+GDkG,CAAalG,IAAQa,UAAW,YAAcC,IAAM8D,QACtE,gBAAC,IAAD,CAAMrE,KAAK,aAKnB,uBAAKM,UAAWC,IAAMQ,QACpB,gBAAC,IAAD,CACEhC,UAAW2D,EAAa0B,EAAcR,eAAiB,CAAE5E,KAAMC,KAC/DC,WAAYkF,EAAcrD,OAC1B5B,SAAU,SAAA4B,GAAM,OAAIiD,EAAmBjD,EAAQtB,YAMzD,qBAAGiB,QAjJP,WACE,IAAMiD,EAAkChE,KAAKC,MAAMD,KAAKE,UAAUsD,IAClEQ,EAAc9B,KAAK,CACjB+B,aAAc,gBACdE,aAAc,2BACd9D,KAAM,KACNiB,GAAIa,cACJf,OAAQ,CACNJ,WAAY,MACZb,aAAc,MAGlBX,EAASwE,KAqIiBN,Q,qBCtO9BrB,EAAOC,QAAU,CAAC,QAAU,wBAAwB,KAAO,qBAAqB,KAAO,qBAAqB,KAAO,qBAAqB,MAAQ,sBAAsB,IAAM,sB,qBCA5KD,EAAOC,QAAU,CAAC,QAAU,+BAA+B,KAAO,4BAA4B,MAAQ,6BAA6B,YAAc,qC,uKC4ElIG,eAhBS,SAACC,GAEvB,MAAO,CACLuD,UAFoBvD,EAAMwD,MAApBD,cAKiB,SAACjD,GAAD,OACzBC,YACE,CACEkD,sBAAuB,SAACC,GACtB,OAAOC,IAAsBhD,QAAQ+C,KAGzCpD,KAGWP,EA9DW,SAAC,GAAuE,IAArE0D,EAAoE,EAApEA,sBAAuBF,EAA6C,EAA7CA,UAAWK,EAAkC,EAAlCA,WAAYC,EAAsB,EAAtBA,SAAsB,EAC/C9G,WAAe,IADgC,mBACxF+G,EADwF,KACtEC,EADsE,KAW/F,OACE,gBAAC,IAAD,CACEC,UAAU,SACVC,QAAQ,QACRC,gBAAiB,SAAC/G,GAAD,OAAWA,GAAS4G,EAAoB,KACzD5B,QACE,2BACE,gBAAC,IAAD,CACE/D,KAAK,QACLtB,SAAU,SAACsF,GAAD,OAAiB2B,EAAoB3B,IAC/CjF,MAAO2G,EACP5F,MAAO,CAAEe,MAAO,KAChBD,KAAK,YAEJuE,EAAU5G,KAAK8B,KAAI,SAACU,GACnB,IAAMgF,IAAYP,EAAWQ,OAAOvG,MAAK,SAACiB,GAAD,OAASA,EAAIF,KAAOO,EAAKP,MAClE,OACE,gBAAC,IAAOtC,OAAR,CAAeoB,IAAKyB,EAAKP,GAAIzB,MAAOgC,EAAKP,GAAIyF,SAAUF,GACpDhF,EAAKJ,UAZhB,OAkBE,gBAAC,IAAD,CAAQX,KAAK,QAAQC,QAAS,kBAhCLiG,EAgCmCV,OA/B7DE,EAAiB9F,OAItByF,EAAsB,CAAEc,SAAUD,EAAO1F,GAAI4F,SAAUV,EAAkBpC,UAAWkC,EAAWlC,YAH7F+C,IAAQpD,KAAK,mCAFjB,IAAiCiD,IAgCzB,iBAKJI,MAAM,4BAELb,M,yjBCiCQ9D,iBAnBS,SAACC,GAEvB,MAAO,CACL4D,WAFqB5D,EAAM2E,OAArBf,eAKiB,SAACtD,GAAD,OACzBC,YACE,CACEqE,YAAa,SAAClB,GACZ,OAAOmB,IAAYlE,QAAQ+C,IAE7BoB,eAAgB,SAACpB,GACf,OAAOqB,KAAepE,QAAQ+C,KAGlCpD,KAGWP,EA3EO,SAAC,GAA8D,IAA5D6D,EAA2D,EAA3DA,WAAYkB,EAA+C,EAA/CA,eAAgBF,EAA+B,EAA/BA,YAAaI,EAAkB,EAAlBA,KAAkB,EACxCjI,IAAMkI,SAASrB,GADyB,mBAC3EsB,EAD2E,KAC5DC,EAD4D,OAElCpI,IAAMkI,SAAS,IAFmB,6BAGlFlI,IAAMqI,WAAU,WACdD,EAAiBvB,KAChB,CAACA,IAeJ,OACE,yBAAK3F,UAAWC,IAAMC,SACpB,wBAAIF,UAAWC,IAAMwG,OACnB,kBAAC,IAAD,CACE/G,KAAK,OACLb,SAAU,SAACsF,GAAD,OAAO+C,EAAiB,EAAD,GAAMD,EAAN,CAAqBnG,KAAMqD,EAAEG,OAAOpF,UACrEA,MAAO+H,EAAcnG,QAGzB,yBAAKd,UAAWC,IAAMmH,MACpB,kBAAC,IAAD,CAAQ1H,KAAK,OAAO2H,KAAK,OAAOjH,QAvBnB,WACY,qBAAlBuF,EAAWhF,GACpBkG,EAAe,EAAD,CAAGlG,GAAI,MAASsG,EAAhB,CAA+BF,UAE7CJ,EAAY,EAAD,GAAMM,EAAN,CAAqBF,YAmB9B,gBAGCE,EAActG,IACb,kBAAC,IAAD,CAAQjB,KAAK,OAAO2H,KAAK,OAAOjH,QAnBnB,WACQ6G,EAAnBtG,GADkB,IACX2G,EADU,YACEL,EADF,QAEzBN,EAAY,EAAD,GAAMW,EAAN,CAAeP,YAiBpB,sBAKDE,EAActG,IACb,kBAAC,EAAD,CAAmBgF,WAAYsB,GAC7B,kBAAC,IAAD,CAAQvH,KAAK,OAAO2H,KAAK,eAAzB,wBAMN,yBAAKrH,UAAWC,IAAMsH,aACpB,kBAAC,IAAD,CACE1I,SAAU,SAACsF,GAAD,OAAO+C,EAAiB,EAAD,GAAMD,EAAN,CAAqBM,YAAapD,EAAEG,OAAOpF,UAC5EA,MAAO+H,EAAcM,oB,kCCjE/B,mEAMQlJ,EAAqBC,IAArBD,OAAqBC,IAAbC,SAiCDiJ,IAzBG,SAAC,GAAuE,IAAD,IAApE/I,iBAAoE,MAAxD,CAAEC,KAAMC,KAAgD,EAAjC8I,EAAiC,EAAjCA,UAAW5I,EAAsB,EAAtBA,SACjE,OACE,uBAAKmB,UAAWC,IAAMC,SACpB,gBAAC,IAAD,CAAKF,UAAWC,IAAMiB,MACpB,gBAAC,IAAD,CAAKN,KAAM,GACT,uBAAKZ,UAAWC,IAAM8D,QAAtB,WAEF,gBAAC,IAAD,CAAKnD,KAAM,GACT,gBAAC,IAAD,CAAQ1B,MAAOuI,EAAW5I,SAAUA,GAClC,gBAACR,EAAD,CAAQa,MAAM,IAAd,gBACCT,EAAUC,KAAK8B,KAAI,SAAAb,GAAK,OACvB,gBAACtB,EAAD,CAAQa,MAAOS,EAAMT,MAAOO,IAAKE,EAAMT,OACpCS,EAAMmB,WAKf,gBAAC,IAAD,CAAKF,KAAM,GACT,uBAAKZ,UAAWC,IAAM8D,QAAtB,qB,qBC/BVrC,EAAOC,QAAU,CAAC,QAAU,2BAA2B,OAAS,4B,qBCAhED,EAAOC,QAAU,CAAC,UAAY,iCAAiC,QAAU,+BAA+B,QAAU,+BAA+B,YAAc,qC,wyBCgBvJtD,EAAWC,IAAXD,OAEAqJ,GADUC,IAAVC,MACU/F,IAAV6F,OA2HO5F,uBAnBS,SAACC,GACvB,IAAM0B,EAAY1B,EAAM8F,QAAQC,YAAYnH,GADE,EAEoBoB,EAAMgG,QACxE,MAAO,CACLtE,YACAuE,kBAL4C,EAEtCA,kBAINC,mBAN4C,EAEnBA,mBAKzBC,eAP4C,EAECA,mBAStB,SAAC7F,GAAD,OACzBC,YACE,CACE6F,uBAAwB,SAAC3F,GAAD,OAAgC4F,IAAmB1F,QAAQF,KAErFH,KAGWP,EAlHO,SAAC,GAOT,IANZoG,EAMW,EANXA,eAEAC,EAIW,EAJXA,uBACA1E,EAGW,EAHXA,UACAuE,EAEW,EAFXA,kBACAC,EACW,EADXA,mBAEMI,EAAe,SAACjF,GACpBA,EAAKK,UAAYA,EACjB0E,EAAuB/E,IAGzB,OACE,yBAAKpD,UAAWC,IAAMC,SACpB,kBAAC,IAAD,CAAe6G,KAAI,KAAOkB,EAAP,CAA2BxE,gBAC9C,yBAAKzD,UAAWC,IAAMqI,MACpB,yBAAKtI,UAAWC,IAAMsI,aACpB,0BAAMvI,UAAWC,IAAMuI,WAAvB,iBAEA,kBAAC,IAAD,CACEtJ,MAAO+I,EAAmBQ,cAC1B5J,SAAU,SAAC4J,GAAD,OAA2BJ,EAAa,EAAD,GAAMJ,EAAN,CAA0BQ,qBAE3E,kBAACpK,EAAD,CAAQa,MAAM,MAAd,gBACA,kBAACb,EAAD,CAAQa,MAAM,MAAd,uBACA,kBAACb,EAAD,CAAQa,MAAM,OAAd,4BACA,kBAACb,EAAD,CAAQa,MAAM,OAAd,4BACA,kBAACb,EAAD,CAAQa,MAAM,OAAd,oCAIJ,yBAAKc,UAAWC,IAAMsI,aACpB,0BAAMvI,UAAWC,IAAMuI,WAAvB,iBACA,kBAAC,IAAD,CACEf,UAAWQ,EAAmBR,UAC9B5I,SAAU,SAAA4I,GAAS,OAAIY,EAAa,EAAD,GAAMJ,EAAN,CAA0BR,mBAIjE,yBAAKzH,UAAWC,IAAMsI,aACpB,0BAAMvI,UAAWC,IAAMuI,WAAvB,iBACA,kBAAC,IAAD,CACE5J,WAAYqJ,EAAmBxH,OAC/B5B,SAAU,SAAA4B,GAAM,OAAI4H,EAAa,EAAD,GAAMJ,EAAN,CAA0BxH,gBAI9D,yBAAKT,UAAWC,IAAMsI,aACpB,0BAAMvI,UAAWC,IAAMuI,WAAvB,6BACA,kBAAC,IAAD,CACEzF,QAAQ,4BACRC,eAAa,EACbH,WAAYoF,EAAmBpF,WAC/BhE,SAAU,SAAAgE,GAAU,OAAIwF,EAAa,EAAD,GAAMJ,EAAN,CAA0BpF,qBAKpE,yBAAK7C,UAAWC,IAAMyI,SACpB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK9H,KAAM,IACT,kBAAC,IAAD,CACE/B,SAAU,SAAA8J,GAAI,OAAIN,EAAa,EAAD,GAAMJ,EAAN,GAA6BU,KAC3DzJ,MAAO,CACL0J,SAAUX,EAAmBW,SAC7BC,QAASZ,EAAmBY,QAC5BC,UAAWb,EAAmBa,cAIpC,kBAAC,IAAD,CAAKlI,KAAM,EAAGmI,OAAQ,GACpB,kBAACrB,EAAD,CAAOsB,SAAO,GACZ,kBAAC,IAAD,CACE/I,MAAO,CAAEe,MAAO,OAChB9B,MAAO+I,EAAmBvI,KAC1Bb,SAAU,SAACa,GAAD,OAAkB2I,EAAa,EAAD,GAAMJ,EAAN,CAA0BvI,YAElE,kBAACrB,EAAD,CAAQa,MAAM,UAAd,sBACA,kBAACb,EAAD,CAAQa,MAAM,QAAd,gBACA,kBAACb,EAAD,CAAQa,MAAM,SAAd,iBAGF,kBAAC,IAAD,CAAQmI,KAAK,YAAb,mBAIN,kBAAC,IAAD,CAAM4B,SAAUf,GACd,kBAAC,IAAD,CAAoBnB,KAAMiB","file":"static/js/9.6fe33604.chunk.js","sourcesContent":["import * as React from 'react';\nimport { Select, Row, Col, Icon, AutoComplete, Button } from 'antd';\nimport style from './Filter.module.less';\nimport { IListData } from '@/types';\nimport { IFieldInfo, IFilterInfo, IFilterValue } from '@/api';\nimport { SelectValue } from 'antd/lib/select';\nimport { v4 as uuidv4 } from 'uuid';\nimport { EVENT_ATTRS } from '@/constants';\nconst { Option, OptGroup } = Select;\n\ninterface Props {\n  fieldList?: IListData<IFieldInfo>;\n  filterInfo: IFilterInfo;\n  onChange: (filterInfo: IFilterInfo) => any;\n}\n\nconst Filter = ({ fieldList = { list: EVENT_ATTRS }, filterInfo, onChange }: Props) => {\n  const [recommend, setrecommend] = React.useState<string[]>([]);\n  const handleFieldChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].key = value;\n    newFilterInfo.filterValues[index].type = 'equal';\n    newFilterInfo.filterValues[index].value = [];\n    const field = fieldList.list.find(field => field.value === value);\n    if (field) {\n      setrecommend(field.recommend);\n    }\n\n    onChange(newFilterInfo);\n  };\n\n  const handleFilterTypeChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].type = value;\n    if (value === 'equal' || value === 'notEqual') {\n      newFilterInfo.filterValues[index].value = [];\n    } else if (value === 'between') {\n      newFilterInfo.filterValues[index].value = [null, null];\n    } else {\n      newFilterInfo.filterValues[index].value = null;\n    }\n    onChange(newFilterInfo);\n  };\n\n  const handleFilterValueChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].value = value;\n    onChange(newFilterInfo);\n  };\n\n  const handleClose = (index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues.splice(index, 1);\n    onChange(newFilterInfo);\n  };\n\n  const handleAdd = () => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues.push({\n      type: null,\n      key: null,\n      value: null,\n      id: uuidv4()\n    });\n    onChange(newFilterInfo);\n  };\n\n  const handleChangeFilterType = () => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterType = newFilterInfo.filterType === 'AND' ? 'OR' : 'AND';\n    onChange(newFilterInfo);\n  };\n\n  return (\n    <div>\n      {filterInfo.filterValues.length > 0 && (\n        <div className={style.wrapper}>\n          {filterInfo.filterValues.length > 1 && (\n            <div className={style.type}>\n              <Button size='small' onClick={handleChangeFilterType}>\n                {filterInfo.filterType === 'AND' ? '且' : '或'}\n              </Button>\n              <div className={style.line}></div>\n            </div>\n          )}\n          <div className={style.form}>\n            {filterInfo.filterValues.map((filter, index) => (\n              <Row gutter={16} key={filter.id}>\n                <Col span={5}>\n                  <Select value={filter.key} onChange={(val: string) => handleFieldChange(val, index)}>\n                    {fieldList.list.map(field => (\n                      <Option value={field.value} key={field.value}>\n                        {field.name}\n                      </Option>\n                    ))}\n                  </Select>\n                </Col>\n                <Col span={3}>\n                  <Select value={filter.type} onChange={(val: string) => handleFilterTypeChange(val, index)}>\n                    <Option value='equal'>等于</Option>\n                    <Option value='notEqual'>不等于</Option>\n                    <Option value='isSet'>有值</Option>\n                    <Option value='notSet'>没值</Option>\n\n                    <Option value='greater'>大于</Option>\n                    <Option value='less'>小于</Option>\n                    <Option value='between'>区间</Option>\n\n                    <Option value='contain'>包含</Option>\n                    <Option value='notContain'>不包含</Option>\n                    <Option value='isEmpty'>为空</Option>\n                    <Option value='isNotEmpty'>不为空</Option>\n                    <Option value='rlike'>正则匹配</Option>\n                    <Option value='notrlike'>正则不匹配</Option>\n                  </Select>\n                </Col>\n                {filter.type !== 'isEmpty' &&\n                  filter.type !== 'isNotEmpty' &&\n                  filter.type !== 'isSet' &&\n                  filter.type !== 'notSet' &&\n                  filter.type !== 'rlike' &&\n                  filter.type !== 'notrlike' && (\n                    <Col span={8}>\n                      {filter.type === 'equal' || filter.type === 'notEqual' ? (\n                        <Select\n                          value={filter.value}\n                          onChange={(val: string) => handleFilterValueChange(val, index)}\n                          mode='tags'\n                          style={{ width: '100%' }}\n                          tokenSeparators={[',']}\n                        >\n                          {recommend.map(item => (\n                            <Option key={item} value={item}>\n                              {item}\n                            </Option>\n                          ))}\n                        </Select>\n                      ) : (\n                        <AutoComplete\n                          value={filter.value}\n                          dataSource={recommend}\n                          style={{ width: '100%' }}\n                          onChange={(val: any) => handleFilterValueChange(val, index)}\n                        />\n                      )}\n                    </Col>\n                  )}\n                <Col span={1}>\n                  <div onClick={() => handleClose(index)} className={'app-link ' + style.close}>\n                    <Icon type='minus-circle' />\n                  </div>\n                </Col>\n              </Row>\n            ))}\n          </div>\n        </div>\n      )}\n      <a onClick={handleAdd} className={style.add}>\n        <Icon type='plus-square' />\n        添加筛选\n      </a>\n    </div>\n  );\n};\n\nexport default Filter;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Indicator_wrapper__3B5qd\",\"select\":\"Indicator_select__1kP-z\",\"content\":\"Indicator_content__3-BaR\",\"center\":\"Indicator_center__3Oax_\",\"metadataBox\":\"Indicator_metadataBox__3wnAQ\",\"active\":\"Indicator_active__1aD9o\",\"filter\":\"Indicator_filter__lBazH\"};","import * as React from 'react';\nimport { Tag, Select, Row, Col, Icon, Popover, Input, Dropdown, Divider } from 'antd';\nimport style from './Indicator.module.less';\nimport {\n  IMetadataInfo,\n  IMetadataListParam,\n  IIndicatorInfo,\n  IFieldInfo,\n  IFilterInfo,\n  ITagList,\n  IFieldListParam\n} from '@/api';\nimport { IPageData, IAction, IStoreState, IListData } from '@/types';\nimport { connect } from 'react-redux';\n\nimport { bindActionCreators, Dispatch } from 'redux';\nimport Filter from './Filter';\nimport { v4 as uuidv4 } from 'uuid';\nimport { doGetActiveMetadataList, doGetFieldList } from '../store/actions';\nimport { IFieldListMap } from '@/store/reducers/metadata.reducer';\nimport { EVENT_ATTRS } from '@/constants';\nconst { Option, OptGroup } = Select;\n\nconst { Search } = Input;\n\ninterface Props {\n  activeMetadataList: IPageData<IMetadataInfo>;\n  activeMetadataListParams: IMetadataListParam;\n  index?: number;\n  fieldListMap: IFieldListMap;\n  indicators: IIndicatorInfo[];\n  onChange: (param: IIndicatorInfo[], changedValue?: IIndicatorInfo) => any;\n  hasType?: boolean;\n  addText?: string;\n  hasCustomName?: boolean;\n  type?: number;\n  tagList: ITagList;\n  onGetActiveMetadataList: (param: IMetadataListParam) => IAction;\n  onGetFieldList: (param: IFieldListParam) => IAction;\n}\n\nconst Indicator = ({\n  indicators,\n  activeMetadataList,\n  activeMetadataListParams,\n  onChange,\n  fieldListMap,\n  hasType,\n  addText = '+添加指标',\n  hasCustomName = false,\n  type = null,\n  tagList,\n  onGetActiveMetadataList,\n  onGetFieldList\n}: Props) => {\n  const [metadataparam, setmetadataparam] = React.useState({ ...activeMetadataListParams });\n  React.useEffect(() => {\n    setmetadataparam(activeMetadataListParams);\n  }, [activeMetadataListParams]);\n\n  function handleSelectMetadata(info: IMetadataInfo, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].metadataCode = info.code;\n    newIndicators[index].metadataName = info.name;\n    onChange(newIndicators, indicators[index]);\n    onGetFieldList({ projectId: info.projectId, metadataCode: info.code });\n  }\n\n  function handleFilterChange(info: IFilterInfo, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].filter = info;\n    onChange(newIndicators);\n  }\n\n  function handleTypeChange(value: string, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].type = value;\n    onChange(newIndicators);\n  }\n\n  function handleNameChange(value: string, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].customName = value;\n    onChange(newIndicators);\n  }\n\n  function handleAdd() {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators.push({\n      metadataCode: '_ALL_METADATA',\n      metadataName: '所有事件',\n      type: 'PV',\n      id: uuidv4(),\n      filter: {\n        filterType: 'AND',\n        filterValues: []\n      }\n    });\n    onChange(newIndicators);\n  }\n\n  function handleRemove(index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators.splice(index, 1);\n    onChange(newIndicators, indicators[index]);\n  }\n\n  function handleSearch(param: IMetadataListParam) {\n    onGetActiveMetadataList(param);\n  }\n\n  const allMetadata = {\n    name: '所有事件',\n    code: '_ALL_METADATA'\n  } as IMetadataInfo;\n\n  return (\n    <div className={style.wrapper}>\n      <div>\n        {indicators.map((indicatorInfo, index) => (\n          <div key={indicatorInfo.id}>\n            <Row className={style.item} gutter={10}>\n              <Col span={1}>\n                <div className={style.center}>\n                  <Tag color='gold'>{index + 1}</Tag>\n                </div>\n              </Col>\n              <Col span={3}>\n                <Dropdown\n                  overlay={\n                    <div className={style.content}>\n                      <div onClick={e => e.stopPropagation()}>\n                        <Search\n                          placeholder='搜索事件'\n                          value={metadataparam.name}\n                          onChange={e => setmetadataparam({ ...metadataparam, name: e.target.value })}\n                          onSearch={name => handleSearch({ ...metadataparam, name })}\n                          style={{ width: 200 }}\n                        />\n                        &nbsp;\n                        <Select\n                          placeholder='根据标签筛选'\n                          style={{ width: 200 }}\n                          mode='multiple'\n                          value={metadataparam.tags ? metadataparam.tags.split(',').map(item => Number(item)) : []}\n                          onChange={(tags: number[]) => handleSearch({ ...metadataparam, tags: tags.join(',') })}\n                        >\n                          {tagList.list.map(item => (\n                            <Option key={item.id} value={item.id}>\n                              {item.name}\n                            </Option>\n                          ))}\n                        </Select>\n                      </div>\n\n                      <div className={style.metadataBox}>\n                        <span\n                          onClick={() => handleSelectMetadata(allMetadata, index)}\n                          className={allMetadata.code === indicatorInfo.metadataCode ? style.active : ''}\n                          key={allMetadata.code}\n                        >\n                          所有事件\n                        </span>\n\n                        {activeMetadataList.list\n                          .filter(item => {\n                            if (!type) {\n                              return true;\n                            }\n                            return item.type === type;\n                          })\n                          .map(item => (\n                            <span\n                              onClick={() => handleSelectMetadata(item, index)}\n                              className={item.code === indicatorInfo.metadataCode ? style.active : ''}\n                              key={item.code}\n                            >\n                              {item.name}\n                            </span>\n                          ))}\n                      </div>\n                    </div>\n                  }\n                >\n                  <Input value={indicatorInfo.metadataName} readOnly className={style.select} />\n                </Dropdown>\n              </Col>\n              {hasCustomName && (\n                <Col span={3}>\n                  <Input\n                    defaultValue={indicatorInfo.customName}\n                    placeholder='自定义名称'\n                    onBlur={event => handleNameChange(event.target.value, index)}\n                  />\n                </Col>\n              )}\n              {hasType && (\n                <>\n                  <Col span={1}>\n                    <div className={style.center}>的</div>\n                  </Col>\n                  <Col span={3}>\n                    <Select onChange={(val: string) => handleTypeChange(val, index)} value={indicatorInfo.type}>\n                      <Option value='PV'>总次数</Option>\n                      <Option value='UV'>用户数</Option>\n                      <Option value='APV'>人均次数</Option>\n                      <Option value='DPV'>日均次数</Option>\n                      <Option value='DUV'>日均用户数</Option>\n                    </Select>\n                  </Col>\n                </>\n              )}\n\n              {indicators.length > 1 && (\n                <Col span={1}>\n                  <div onClick={() => handleRemove(index)} className={'app-link ' + style.center}>\n                    <Icon type='close' />\n                  </div>\n                </Col>\n              )}\n            </Row>\n            <div className={style.filter}>\n              <Filter\n                fieldList={fieldListMap[indicatorInfo.metadataCode] || { list: EVENT_ATTRS }}\n                filterInfo={indicatorInfo.filter}\n                onChange={filter => handleFilterChange(filter, index)}\n              ></Filter>\n            </div>\n          </div>\n        ))}\n      </div>\n      <a onClick={handleAdd}>{addText}</a>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const { activeMetadataList, activeMetadataListParams, tagList, fieldListMap } = state.metadata;\n  return {\n    activeMetadataList,\n    activeMetadataListParams,\n    tagList,\n    fieldListMap\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onGetActiveMetadataList: param => doGetActiveMetadataList.request(param),\n      onGetFieldList: param => doGetFieldList.request(param)\n    },\n\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Indicator);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Filter_wrapper__9rptJ\",\"line\":\"Filter_line__eOPS4\",\"type\":\"Filter_type__2GtXQ\",\"form\":\"Filter_form__1lfK0\",\"close\":\"Filter_close__1AZpi\",\"add\":\"Filter_add__2YNj8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"AnalyseHeader_wrapper__1r0g1\",\"btns\":\"AnalyseHeader_btns__G6iwS\",\"title\":\"AnalyseHeader_title__1X3LF\",\"description\":\"AnalyseHeader_description__1fJOY\"};","import * as React from 'react';\nimport { Popover, Select, Button, message } from 'antd';\nimport { IAction, IStoreState } from '@/types';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { IBoardList, IReportInfo, IReportAppendToBoard } from '@/api';\nimport { doAppendReportToBoard } from '@/store/actions';\n\ninterface Props {\n  boardList: IBoardList;\n  reportInfo: IReportInfo;\n  onAppendReportToBoard: (param: IReportAppendToBoard) => IAction;\n  children: React.ReactNode;\n}\n\nconst ReportAppendBoard = ({ onAppendReportToBoard, boardList, reportInfo, children }: Props) => {\n  const [appendedBoardIds, setappendedBoardIds] = React.useState([]);\n\n  function handleReportAppendBoard(record: IReportInfo) {\n    if (!appendedBoardIds.length) {\n      message.info('请选择看板');\n      return;\n    }\n    onAppendReportToBoard({ reportId: record.id, boardIds: appendedBoardIds, projectId: reportInfo.projectId });\n  }\n\n  return (\n    <Popover\n      placement='bottom'\n      trigger='click'\n      onVisibleChange={(value) => value && setappendedBoardIds([])}\n      content={\n        <div>\n          <Select\n            size='small'\n            onChange={(e: number[]) => setappendedBoardIds(e)}\n            value={appendedBoardIds}\n            style={{ width: 240 }}\n            mode='multiple'\n          >\n            {boardList.list.map((item) => {\n              const isExist = !!reportInfo.boards.find((val) => val.id === item.id);\n              return (\n                <Select.Option key={item.id} value={item.id} disabled={isExist}>\n                  {item.name}\n                </Select.Option>\n              );\n            })}\n          </Select>\n          &nbsp;\n          <Button size='small' onClick={() => handleReportAppendBoard(reportInfo)}>\n            确定\n          </Button>\n        </div>\n      }\n      title='选择看板'\n    >\n      {children}\n    </Popover>\n  );\n};\nconst mapStateToProps = (state: IStoreState) => {\n  const { boardList } = state.board;\n  return {\n    boardList\n  };\n};\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onAppendReportToBoard: (params: IReportAppendToBoard) => {\n        return doAppendReportToBoard.request(params);\n      }\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ReportAppendBoard);\n","import React from 'react';\nimport { Icon, Button, Input, message, Select, Popover } from 'antd';\nimport { connect } from 'react-redux';\nimport { IAction, IStoreState } from '@/types';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doAddReport, doUpdateReport, doAppendReportToBoard } from '@/store/actions';\nimport { IReportAddParam, IReportUpdateParam, IReportInfo, IReportAppendToBoard } from '@/api';\nimport style from './AnalyseHeader.module.less';\nimport ReportAppendBoard from '@/components/ReportAppendBoard';\ninterface Props {\n  reportInfo: IReportInfo;\n  onAddReport: (params: IReportAddParam) => IAction;\n  onUpdateReport: (params: IReportUpdateParam) => IAction;\n  data: Object;\n}\nconst AnalyseHeader = ({ reportInfo, onUpdateReport, onAddReport, data }: Props) => {\n  const [newReportInfo, setnewReportInfo] = React.useState(reportInfo);\n  const [appendedBoardIds, setappendedBoardIds] = React.useState([]);\n  React.useEffect(() => {\n    setnewReportInfo(reportInfo);\n  }, [reportInfo]);\n\n  const handleSave = () => {\n    if (typeof reportInfo.id !== 'undefined') {\n      onUpdateReport({ id: null, ...newReportInfo, data });\n    } else {\n      onAddReport({ ...newReportInfo, data });\n    }\n  };\n\n  const handleSaveAs = () => {\n    const { id, ...newInfo } = newReportInfo;\n    onAddReport({ ...newInfo, data });\n  };\n\n  return (\n    <div className={style.wrapper}>\n      <h2 className={style.title}>\n        <Input\n          type='text'\n          onChange={(e) => setnewReportInfo({ ...newReportInfo, name: e.target.value })}\n          value={newReportInfo.name}\n        />\n      </h2>\n      <div className={style.btns}>\n        <Button type='link' icon='save' onClick={handleSave}>\n          保存\n        </Button>\n        {newReportInfo.id && (\n          <Button type='link' icon='save' onClick={handleSaveAs}>\n            另存为\n          </Button>\n        )}\n\n        {newReportInfo.id && (\n          <ReportAppendBoard reportInfo={newReportInfo}>\n            <Button type='link' icon='plus-circle'>\n              添加到\n            </Button>\n          </ReportAppendBoard>\n        )}\n      </div>\n      <div className={style.description}>\n        <Input\n          onChange={(e) => setnewReportInfo({ ...newReportInfo, description: e.target.value })}\n          value={newReportInfo.description}\n        ></Input>\n      </div>\n    </div>\n  );\n};\nconst mapStateToProps = (state: IStoreState) => {\n  const { reportInfo } = state.report;\n  return {\n    reportInfo\n  };\n};\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onAddReport: (params: IReportAddParam) => {\n        return doAddReport.request(params);\n      },\n      onUpdateReport: (params: IReportUpdateParam) => {\n        return doUpdateReport.request(params);\n      }\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnalyseHeader);\n","import * as React from 'react';\nimport { Select, Row, Col, Icon } from 'antd';\nimport style from './Dimension.module.less';\nimport { IFieldInfo } from '@/api';\nimport { IListData } from '@/types';\nimport { EVENT_ATTRS } from '@/constants';\nconst { Option, OptGroup } = Select;\n\ninterface Props {\n  fieldList?: IListData<IFieldInfo>;\n  dimension: string;\n  onChange: (param: string) => any;\n}\n\nconst Dimension = ({ fieldList = { list: EVENT_ATTRS }, dimension, onChange }: Props) => {\n  return (\n    <div className={style.wrapper}>\n      <Row className={style.item}>\n        <Col span={1}>\n          <div className={style.center}>按</div>\n        </Col>\n        <Col span={3}>\n          <Select value={dimension} onChange={onChange}>\n            <Option value=''>总体</Option>\n            {fieldList.list.map(field => (\n              <Option value={field.value} key={field.value}>\n                {field.name}\n              </Option>\n            ))}\n          </Select>\n        </Col>\n        <Col span={1}>\n          <div className={style.center}>查看</div>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n\nexport default Dimension;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Dimension_wrapper__Ew76P\",\"center\":\"Dimension_center__1BCis\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ruleTitle\":\"AnalyseFunnel_ruleTitle__3gwQF\",\"preview\":\"AnalyseFunnel_preview__18PLM\",\"wrapper\":\"AnalyseFunnel_wrapper__29QoJ\",\"ruleSection\":\"AnalyseFunnel_ruleSection__3K-yu\"};","import { Icon, Collapse, Divider, Select, Input, Row, Col, Button, Spin } from 'antd';\nimport React from 'react';\nimport AnalyseRangePicker from '@/components/AnalyseRangePicker';\nimport moment from 'moment';\nimport style from './AnalyseFunnel.module.less';\nimport ReactEcharts from 'echarts-for-react';\nimport Indicator from '@/components/Indicator';\nimport Dimension from '@/components/Dimension';\nimport Filter from '@/components/Filter';\nimport AnalyseHeader from './components/AnalyseHeader';\nimport { IReportInfo, IFieldInfo, IFunnelAnalyseData, IFunnelAnalyseParam } from '@/api';\nimport { connect } from 'react-redux';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doAddReport, doUpdateReport, doGetFunnelAnalyse } from '@/store/actions';\nimport { IAction, IStoreState, IListData, IDate } from '@/types';\nimport { DYNAMIC_TIME, EVENT_ATTRS } from '@/constants';\nimport AnalyseFunnelChart from './components/AnalyseFunnelChart';\nconst { Option } = Select;\nconst { Panel } = Collapse;\nconst { Group } = Input;\ninterface Props {\n  onGetFunnelAnalyseData: (param: IFunnelAnalyseParam) => IAction;\n  projectId: number;\n  funnelAnalyseData: IFunnelAnalyseData;\n  funnelAnalyseParam: IFunnelAnalyseParam;\n  analyseLoading: boolean;\n}\n\nconst AnalyseFunnel = ({\n  analyseLoading,\n\n  onGetFunnelAnalyseData,\n  projectId,\n  funnelAnalyseData,\n  funnelAnalyseParam\n}: Props) => {\n  const handleChange = (info: IFunnelAnalyseParam) => {\n    info.projectId = projectId;\n    onGetFunnelAnalyseData(info);\n  };\n\n  return (\n    <div className={style.wrapper}>\n      <AnalyseHeader data={{ ...funnelAnalyseParam, projectId }}></AnalyseHeader>\n      <div className={style.rule}>\n        <div className={style.ruleSection}>\n          <span className={style.ruleTitle}>指标:</span>\n\n          <Select\n            value={funnelAnalyseParam.indicatorType}\n            onChange={(indicatorType: string) => handleChange({ ...funnelAnalyseParam, indicatorType })}\n          >\n            <Option value='PV'>总数</Option>\n            <Option value='UV'> 用户数</Option>\n            <Option value='APV'>人均次数</Option>\n            <Option value='DPV'>日均次数</Option>\n            <Option value='DUV'>日均用户数</Option>\n          </Select>\n        </div>\n\n        <div className={style.ruleSection}>\n          <span className={style.ruleTitle}>纬度:</span>\n          <Dimension\n            dimension={funnelAnalyseParam.dimension}\n            onChange={dimension => handleChange({ ...funnelAnalyseParam, dimension })}\n          />\n        </div>\n\n        <div className={style.ruleSection}>\n          <span className={style.ruleTitle}>筛选:</span>\n          <Filter\n            filterInfo={funnelAnalyseParam.filter}\n            onChange={filter => handleChange({ ...funnelAnalyseParam, filter })}\n          />\n        </div>\n\n        <div className={style.ruleSection}>\n          <span className={style.ruleTitle}>漏斗步骤:</span>\n          <Indicator\n            addText='+添加步骤'\n            hasCustomName\n            indicators={funnelAnalyseParam.indicators}\n            onChange={indicators => handleChange({ ...funnelAnalyseParam, indicators })}\n          />\n        </div>\n      </div>\n\n      <div className={style.preview}>\n        <Row>\n          <Col span={14}>\n            <AnalyseRangePicker\n              onChange={time => handleChange({ ...funnelAnalyseParam, ...time })}\n              value={{\n                dateType: funnelAnalyseParam.dateType,\n                dateEnd: funnelAnalyseParam.dateEnd,\n                dateStart: funnelAnalyseParam.dateStart\n              }}\n            />\n          </Col>\n          <Col span={6} offset={4}>\n            <Group compact>\n              <Select\n                style={{ width: '33%' }}\n                value={funnelAnalyseParam.type}\n                onChange={(type: string) => handleChange({ ...funnelAnalyseParam, type })}\n              >\n                <Option value='FUNNEL'>漏斗图</Option>\n                <Option value='LIST'>列表</Option>\n                <Option value='TABLE'>表格</Option>\n              </Select>\n\n              <Button icon='download'>导出</Button>\n            </Group>\n          </Col>\n        </Row>\n        <Spin spinning={analyseLoading}>\n          <AnalyseFunnelChart data={funnelAnalyseData}></AnalyseFunnelChart>\n        </Spin>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const projectId = state.project.projectInfo.id;\n  const { funnelAnalyseData, funnelAnalyseParam, analyseLoading } = state.analyse;\n  return {\n    projectId,\n    funnelAnalyseData,\n    funnelAnalyseParam,\n    analyseLoading\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onGetFunnelAnalyseData: (param: IFunnelAnalyseParam) => doGetFunnelAnalyse.request(param)\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnalyseFunnel);\n"],"sourceRoot":""}