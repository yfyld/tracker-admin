{"version":3,"sources":["components/Indicator.tsx","components/Indicator.module.less","components/Filter.module.less","components/Dimension.tsx","components/Dimension.module.less","pages/analyse/components/AnalyseHeader.tsx","pages/analyse/components/AnalyseHeader.module.less","pages/analyse/AnalyseEvent.module.less","pages/analyse/AnalyseEvent.tsx","components/Filter.tsx"],"names":["Option","Select","Search","OptGroup","Input","connect","state","metadata","activeMetadataList","activeMetadataListParams","dispatch","bindActionCreators","indicators","onChange","fieldList","hasType","addText","hasCustomName","handleFilterChange","info","index","newIndicators","JSON","parse","stringify","filter","handleTypeChange","value","type","className","style","wrapper","map","indicatorInfo","key","id","item","gutter","span","center","color","overlay","content","onClick","e","stopPropagation","placeholder","onSearch","console","log","width","metadataBox","list","trackId","code","metadataCode","metadataName","name","handleSelectMetadata","readOnly","select","defaultValue","customName","onBlur","event","handleNameChange","target","val","length","splice","handleRemove","filterInfo","push","Date","now","filterType","filterValues","module","exports","Dimension","dimension","field","reportInfo","report","handleAddReport","params","doAddReport","request","handleUpdateReport","doUpdateReport","data","React","useState","newReportInfo","setnewReportInfo","useEffect","title","btns","icon","description","Panel","Collapse","Group","projectId","project","projectInfo","analyse","eventAnalyseData","eventAnalyseParam","analyseLoading","onGetEventAnalyseData","param","doGetEventAnalyse","handleChange","defaultActiveKey","header","ruleTitle","preview","pickerProps","allowClear","time","dateType","dateEnd","dateStart","offset","compact","timeUnit","spinning","Filter","recommend","setrecommend","handleFieldChange","newFilterInfo","find","handleFilterTypeChange","handleFilterValueChange","line","form","mode","tokenSeparators","dataSource","handleClose","close"],"mappings":"uHAAA,sHASQA,EAAqBC,IAArBD,OAEAE,GAFqBD,IAAbE,SAEGC,IAAXF,QA0KOG,iBAVS,SAACC,GAAwB,IAAD,EACWA,EAAMC,SAC/D,MAAO,CACLC,mBAH4C,EACtCA,mBAGNC,yBAJ4C,EAClBA,6BAOH,SAACC,GAAD,OAAiCC,YAAmB,GAAID,KAEpEL,EA5JG,SAAC,GASL,IARZO,EAQW,EARXA,WACAJ,EAOW,EAPXA,mBAEAK,GAKW,EANXJ,yBAMW,EALXI,UACAC,EAIW,EAJXA,UACAC,EAGW,EAHXA,QAGW,IAFXC,eAEW,MAFD,4BAEC,MADXC,qBACW,SASX,SAASC,EAAmBC,EAAmBC,GAC7C,IAAMC,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcD,GAAOK,OAASN,EAC9BN,EAASQ,GAGX,SAASK,EAAiBC,EAAeP,GACvC,IAAMC,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcD,GAAOQ,KAAOD,EAC5Bd,EAASQ,GA+BX,OACE,uBAAKQ,UAAWC,IAAMC,SACpB,2BACGnB,EAAWoB,KAAI,SAACC,EAAeb,GAAhB,OACd,uBAAKc,IAAKD,EAAcE,IACtB,gBAAC,IAAD,CAAKN,UAAWC,IAAMM,KAAMC,OAAQ,IAClC,gBAAC,IAAD,CAAKC,KAAM,GACT,uBAAKT,UAAWC,IAAMS,QACpB,gBAAC,IAAD,CAAKC,MAAM,QAAQpB,EAAQ,KAG/B,gBAAC,IAAD,CAAKkB,KAAM,GACT,gBAAC,IAAD,CACEG,QACE,uBAAKZ,UAAWC,IAAMY,SACpB,uBAAKC,QAAS,SAAAC,GAAC,OAAIA,EAAEC,oBACnB,gBAAC3C,EAAD,CAAQ4C,YAAY,2BAAOC,SAAU,SAAApB,GAAK,OAAIqB,QAAQC,IAAItB,IAAQG,MAAO,CAAEoB,MAAO,OAClF,gBAAC,IAAD,CAAQpB,MAAO,CAAEoB,MAAO,MACtB,gBAAClD,EAAD,CAAQ2B,MAAM,KAAd,iBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,KAAd,iBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,KAAd,mBAIJ,uBAAKE,UAAWC,IAAMqB,aACnB3C,EAAmB4C,KAAKpB,KAAI,SAAAI,GAAI,OAC/B,wBACEO,QAAS,kBA3EnC,SAA8BxB,EAAqBC,GACjD,IAAMC,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcD,GAAOiC,QAAUlC,EAAKmC,KACpCjC,EAAcD,GAAOmC,aAAepC,EAAKmC,KACzCjC,EAAcD,GAAOoC,aAAerC,EAAKsC,KACzC5C,EAASQ,GAsE8BqC,CAAqBtB,EAAMhB,IAC1CS,UAAU,cACVK,IAAKE,EAAKkB,MAETlB,EAAKqB,YAOhB,gBAAC,IAAD,CAAO9B,MAAOM,EAAcuB,aAAcG,UAAQ,EAAC9B,UAAWC,IAAM8B,WAGvE3C,GACC,gBAAC,IAAD,CAAKqB,KAAM,GACT,gBAAC,IAAD,CACEuB,aAAc5B,EAAc6B,WAC5BhB,YAAY,iCACZiB,OAAQ,SAAAC,GAAK,OA1E/B,SAA0BrC,EAAeP,GACvC,IAAMC,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcD,GAAO0C,WAAanC,EAClCd,EAASQ,GAuEwB4C,CAAiBD,EAAME,OAAOvC,MAAOP,OAI3DL,GACC,gCACE,gBAAC,IAAD,CAAKuB,KAAM,GACT,uBAAKT,UAAWC,IAAMS,QAAtB,WAEF,gBAAC,IAAD,CAAKD,KAAM,GACT,gBAAC,IAAD,CAAQzB,SAAU,SAACsD,GAAD,OAAiBzC,EAAiByC,EAAK/C,IAAQO,MAAOM,EAAcL,MACpF,gBAAC5B,EAAD,CAAQ2B,MAAM,OAAd,sBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,YAAd,sBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,KAAd,+BAMPf,EAAWwD,OAAS,GACnB,gBAAC,IAAD,CAAK9B,KAAM,GACT,uBAAKK,QAAS,kBAzE9B,SAAsBvB,GACpB,IAAMC,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcgD,OAAOjD,EAAO,GAC5BP,EAASQ,GAsEyBiD,CAAalD,IAAQS,UAAW,YAAcC,IAAMS,QACtE,gBAAC,IAAD,CAAMX,KAAK,aAKnB,uBAAKC,UAAWC,IAAML,QACpB,gBAAC,IAAD,CACEX,UAAWA,EACXyD,WAAYtC,EAAcR,OAC1BZ,SAAU,SAAAY,GAAM,OAAIP,EAAmBO,EAAQL,YAMzD,qBAAGuB,QAzGP,WACE,IAAMtB,EAAkCC,KAAKC,MAAMD,KAAKE,UAAUZ,IAClES,EAAcmD,KAAK,CACjBnB,QAAS,KACTE,aAAc,KACdC,aAAc,2BACd5B,KAAM,MACNO,GAAIsC,KAAKC,MACTjD,OAAQ,CACNkD,WAAY,MACZC,aAAc,MAGlB/D,EAASQ,KA4FiBL,Q,qBCrK9B6D,EAAOC,QAAU,CAAC,QAAU,2BAA2B,OAAS,0BAA0B,QAAU,2BAA2B,OAAS,0BAA0B,YAAc,+BAA+B,OAAS,0BAA0B,OAAS,4B,qBCA3PD,EAAOC,QAAU,CAAC,QAAU,wBAAwB,KAAO,qBAAqB,KAAO,qBAAqB,KAAO,qBAAqB,MAAQ,wB,kCCDhJ,0DAKQ9E,EAAqBC,IAArBD,OAAqBC,IAAbE,SAiCD4E,IAzBG,SAAC,GAA+C,IAA7CjE,EAA4C,EAA5CA,UAAWkE,EAAiC,EAAjCA,UAAWnE,EAAsB,EAAtBA,SACzC,OACE,uBAAKgB,UAAWC,IAAMC,SACpB,gBAAC,IAAD,CAAKF,UAAWC,IAAMM,MACpB,gBAAC,IAAD,CAAKE,KAAM,GACT,uBAAKT,UAAWC,IAAMS,QAAtB,WAEF,gBAAC,IAAD,CAAKD,KAAM,GACT,gBAAC,IAAD,CAAQX,MAAOqD,EAAWnE,SAAUA,GAClC,gBAACb,EAAD,CAAQ2B,MAAM,IAAd,gBACCb,EAAUsC,KAAKpB,KAAI,SAAAiD,GAAK,OACvB,gBAACjF,EAAD,CAAQ2B,MAAOsD,EAAMtD,MAAOO,IAAK+C,EAAMtD,OACpCsD,EAAMxB,WAKf,gBAAC,IAAD,CAAKnB,KAAM,GACT,uBAAKT,UAAWC,IAAMS,QAAtB,qB,qBC9BVsC,EAAOC,QAAU,CAAC,QAAU,2BAA2B,OAAS,4B,2rBCsFjDzE,iBAnBS,SAACC,GAEvB,MAAO,CACL4E,WAFqB5E,EAAM6E,OAArBD,eAKiB,SAACxE,GAAD,OACzBC,YACE,CACEyE,gBAAiB,SAACC,GAChB,OAAOC,IAAYC,QAAQF,IAE7BG,mBAAoB,SAACH,GACnB,OAAOI,IAAeF,QAAQF,KAGlC3E,KAGWL,EAxEO,SAAC,GAAsE,IAApE6E,EAAmE,EAAnEA,WAAYM,EAAuD,EAAvDA,mBAAoBJ,EAAmC,EAAnCA,gBAAiBM,EAAkB,EAAlBA,KAAkB,EAChDC,IAAMC,SAASV,GADiC,mBACnFW,EADmF,KACpEC,EADoE,KAE1FH,IAAMI,WAAU,WACdD,EAAiBZ,KAChB,CAACA,IAkBJ,OACE,yBAAKrD,UAAWC,IAAMC,SACpB,wBAAIF,UAAWC,IAAMkE,OACnB,kBAAC,IAAD,CACEpE,KAAK,OACLf,SAAU,SAAA+B,GAAC,OAAIkD,EAAiB,EAAD,GAAMD,EAAN,CAAqBpC,KAAMb,EAAEsB,OAAOvC,UACnEA,MAAOkE,EAAcpC,QAGzB,yBAAK5B,UAAWC,IAAMmE,MACpB,kBAAC,IAAD,CAAQrE,KAAK,OAAOsE,KAAK,OAAOvD,QA1BnB,WACY,qBAAlBuC,EAAW/C,GACpBqD,EAAmB,EAAD,CAAGrD,GAAI,MAAS0D,EAAhB,CAA+BH,UAEjDN,EAAgB,EAAD,GAAMS,EAAN,CAAqBH,YAsBlC,gBAGCG,EAAc1D,IACb,kBAAC,IAAD,CAAQP,KAAK,OAAOsE,KAAK,OAAOvD,QAtBnB,WACnByC,EAAgB,EAAD,GAAMS,EAAN,CAAqBH,YAqB9B,sBAIF,kBAAC,IAAD,CAAQ9D,KAAK,OAAOsE,KAAK,cAAcvD,QAtBxB,cAsBf,uBAIF,yBAAKd,UAAWC,IAAMqE,aACpB,kBAAC,IAAD,CACEtF,SAAU,SAAA+B,GAAC,OAAIkD,EAAiB,EAAD,GAAMD,EAAN,CAAqBM,YAAavD,EAAEsB,OAAOvC,UAC1EA,MAAOkE,EAAcM,oB,qBC7D/BtB,EAAOC,QAAU,CAAC,QAAU,+BAA+B,KAAO,4BAA4B,MAAQ,6BAA6B,YAAc,qC,qBCAjJD,EAAOC,QAAU,CAAC,UAAY,gCAAgC,QAAU,gC,qyBCgBhE9E,EAAWC,IAAXD,OACAoG,EAAUC,IAAVD,MACAE,EAAUlG,IAAVkG,MA0IOjG,uBArBS,SAACC,GAAwB,IACvCQ,EAAcR,EAAMC,SAApBO,UACFyF,EAAYjG,EAAMkG,QAAQC,YAAYtE,GAFE,EAGkB7B,EAAMoG,QACtE,MAAO,CACL5F,YACAyF,YACAI,iBAP4C,EAGtCA,iBAKNC,kBAR4C,EAGpBA,kBAMxBC,eAT4C,EAGDA,mBAUpB,SAACnG,GAAD,OACzBC,YACE,CACEmG,sBAAuB,SAACC,GAAD,OAA+BC,IAAkBzB,QAAQwB,KAElFrG,KAGWL,EAhIM,SAAC,GAOR,IANZwG,EAMW,EANXA,eACA/F,EAKW,EALXA,UACAgG,EAIW,EAJXA,sBACAP,EAGW,EAHXA,UACAI,EAEW,EAFXA,iBACAC,EACW,EADXA,kBAEMK,EAAe,SAAC9F,GACpBA,EAAKoF,UAAYA,EACjBO,EAAsB3F,IAGxB,OACE,6BACE,kBAAC,IAAD,CAAeuE,KAAI,KAAOkB,EAAP,CAA0BL,gBAC7C,kBAAC,IAAD,CAAUW,iBAAkB,CAAC,MAC3B,kBAACd,EAAD,CAAOe,OAAO,uCAASjF,IAAI,KACzB,6BACE,yBAAKL,UAAWC,IAAMsF,WACpB,gDAEF,6BACE,kBAAC,IAAD,CACErG,SAAO,EACPD,UAAWA,EACXF,WAAYgG,EAAkBhG,WAC9BC,SAAU,SAAAD,GAAU,OAAIqG,EAAa,EAAD,GAAML,EAAN,CAAyBhG,qBAOnE,6BACE,yBAAKiB,UAAWC,IAAMsF,WACpB,gDAEF,kBAAC,IAAD,CACEpC,UAAW4B,EAAkB5B,UAC7BlE,UAAWA,EACXD,SAAU,SAAAmE,GAAS,OAAIiC,EAAa,EAAD,GAAML,EAAN,CAAyB5B,mBAIhE,6BACE,yBAAKnD,UAAWC,IAAMsF,WACpB,gDAEF,kBAAC,IAAD,CACEtG,UAAWA,EACXyD,WAAYqC,EAAkBnF,OAC9BZ,SAAU,SAAAY,GAAM,OAAIwF,EAAa,EAAD,GAAML,EAAN,CAAyBnF,kBAMjE,yBAAKI,UAAWC,IAAMuF,SACpB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK/E,KAAM,IACT,kBAAC,IAAD,CACEgF,YAAa,CAAEC,YAAY,GAC3B1G,SAAU,SAAA2G,GAAI,OAAIP,EAAa,EAAD,GAAML,EAAN,GAA4BY,KAC1D7F,MAAO,CACL8F,SAAUb,EAAkBa,SAC5BC,QAASd,EAAkBc,QAC3BC,UAAWf,EAAkBe,cAInC,kBAAC,IAAD,CAAKrF,KAAM,EAAGsF,OAAQ,GACpB,kBAACtB,EAAD,CAAOuB,SAAO,GACZ,kBAAC,IAAD,CACE/F,MAAO,CAAEoB,MAAO,OAChBvB,MAAOiF,EAAkBhF,KACzBf,SAAU,SAACe,GAAD,OAAkBqF,EAAa,EAAD,GAAML,EAAN,CAAyBhF,YAEjE,kBAAC5B,EAAD,CAAQ2B,MAAM,QAAd,sBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,OAAd,gBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,SAAd,gBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,QAAd,iBAEF,kBAAC,IAAD,CACEG,MAAO,CAAEoB,MAAO,OAChBvB,MAAOiF,EAAkBkB,SACzBjH,SAAU,SAACiH,GAAD,OAAsBb,EAAa,EAAD,GAAML,EAAN,CAAyBkB,gBAErE,kBAAC9H,EAAD,CAAQ2B,MAAM,QAAd,sBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,OAAd,gBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,QAAd,gBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,SAAd,gBACA,kBAAC3B,EAAD,CAAQ2B,MAAM,QAAd,iBAEF,kBAAC,IAAD,CAAQuE,KAAK,YAAb,mBAIN,kBAAC,IAAD,CAAM6B,SAAUlB,GACd,kBAAC,IAAD,CAAmBnB,KAAMiB,KAE3B,oC,sHC5HA3G,EAAqBC,IAArBD,OAAqBC,IAAbE,SAwJD6H,IAhJA,SAAC,GAAgD,IAA9ClH,EAA6C,EAA7CA,UAAWyD,EAAkC,EAAlCA,WAAY1D,EAAsB,EAAtBA,SAAsB,EAC3B8E,WAAyB,IADE,mBACtDsC,EADsD,KAC3CC,EAD2C,KAEvDC,EAAoB,SAACxG,EAAeP,GACxC,IAAMgH,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAcxD,aAAaxD,GAAOc,IAAMP,EACxCyG,EAAcxD,aAAaxD,GAAOQ,KAAO,QACzCwG,EAAcxD,aAAaxD,GAAOO,MAAQ,GAC1C,IAAMsD,EAAQnE,EAAUsC,KAAKiF,MAAK,SAAApD,GAAK,OAAIA,EAAMtD,QAAUA,KACvDsD,GACFiD,EAAajD,EAAMgD,WAGrBpH,EAASuH,IAGLE,EAAyB,SAAC3G,EAAeP,GAC7C,IAAMgH,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAcxD,aAAaxD,GAAOQ,KAAOD,EAEvCyG,EAAcxD,aAAaxD,GAAOO,MADtB,UAAVA,GAA+B,aAAVA,EACmB,GACvB,YAAVA,EACiC,CAAC,KAAM,MAEP,KAE5Cd,EAASuH,IAGLG,EAA0B,SAAC5G,EAAeP,GAC9C,IAAMgH,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAcxD,aAAaxD,GAAOO,MAAQA,EAC1Cd,EAASuH,IA0BX,OACE,2BACG7D,EAAWK,aAAaR,OAAS,GAChC,uBAAKvC,UAAWC,IAAMC,SACnBwC,EAAWK,aAAaR,OAAS,GAChC,uBAAKvC,UAAWC,IAAMF,MACpB,0BAAQe,QAZW,WAC7B,IAAMyF,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAczD,WAA0C,QAA7ByD,EAAczD,WAAuB,KAAO,MACvE9D,EAASuH,KASqE,QAA1B7D,EAAWI,WAAuB,SAAM,UAClF,uBAAK9C,UAAWC,IAAM0G,QAG1B,uBAAK3G,UAAWC,IAAM2G,MACnBlE,EAAWK,aAAa5C,KAAI,SAACP,EAAQL,GAAT,OAC3B,gBAAC,IAAD,CAAKiB,OAAQ,GAAIH,IAAKT,EAAOU,IAC3B,gBAAC,IAAD,CAAKG,KAAM,GACT,gBAAC,IAAD,CAAQX,MAAOF,EAAOS,IAAKrB,SAAU,SAACsD,GAAD,OAAiBgE,EAAkBhE,EAAK/C,KAC1EN,EAAUsC,KAAKpB,KAAI,SAAAiD,GAAK,OACvB,gBAACjF,EAAD,CAAQ2B,MAAOsD,EAAMtD,MAAOO,IAAK+C,EAAMtD,OACpCsD,EAAMxB,WAKf,gBAAC,IAAD,CAAKnB,KAAM,GACT,gBAAC,IAAD,CAAQX,MAAOF,EAAOG,KAAMf,SAAU,SAACsD,GAAD,OAAiBmE,EAAuBnE,EAAK/C,KACjF,gBAACpB,EAAD,CAAQ2B,MAAM,SAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,YAAd,sBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,SAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,UAAd,gBAEA,gBAAC3B,EAAD,CAAQ2B,MAAM,WAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,QAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,WAAd,gBAEA,gBAAC3B,EAAD,CAAQ2B,MAAM,WAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,cAAd,sBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,WAAd,gBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,cAAd,sBACA,gBAAC3B,EAAD,CAAQ2B,MAAM,SAAd,4BACA,gBAAC3B,EAAD,CAAQ2B,MAAM,YAAd,oCAGa,YAAhBF,EAAOG,MACU,eAAhBH,EAAOG,MACS,UAAhBH,EAAOG,MACS,WAAhBH,EAAOG,MACS,UAAhBH,EAAOG,MACS,aAAhBH,EAAOG,MACL,gBAAC,IAAD,CAAKU,KAAM,GACQ,UAAhBb,EAAOG,MAAoC,aAAhBH,EAAOG,KACjC,gBAAC,IAAD,CACED,MAAOF,EAAOE,MACdd,SAAU,SAACsD,GAAD,OAAiBoE,EAAwBpE,EAAK/C,IACxDsH,KAAK,OACL5G,MAAO,CAAEoB,MAAO,QAChByF,gBAAiB,CAAC,MAEjBV,EAAUjG,KAAI,SAAAI,GAAI,OACjB,gBAACpC,EAAD,CAAQkC,IAAKE,EAAMT,MAAOS,GACvBA,OAKP,gBAAC,IAAD,CACET,MAAOF,EAAOE,MACdiH,WAAYX,EACZnG,MAAO,CAAEoB,MAAO,QAChBrC,SAAU,SAACsD,GAAD,OAAcoE,EAAwBpE,EAAK/C,OAK/D,gBAAC,IAAD,CAAKkB,KAAM,GACT,uBAAKK,QAAS,kBAhGV,SAACvB,GACnB,IAAMgH,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAcxD,aAAaP,OAAOjD,EAAO,GACzCP,EAASuH,GA6FyBS,CAAYzH,IAAQS,UAAW,YAAcC,IAAMgH,OACrE,gBAAC,IAAD,CAAMlH,KAAK,kBAQzB,qBAAGe,QAnGW,WAChB,IAAMyF,EAA6B9G,KAAKC,MAAMD,KAAKE,UAAU+C,IAC7D6D,EAAcxD,aAAaJ,KAAK,CAC9B5C,KAAM,KACNM,IAAK,KACLP,MAAO,KACPQ,GAAIsC,KAAKC,QAEX7D,EAASuH,KA2FP","file":"static/js/7.6dfa8a98.chunk.js","sourcesContent":["import * as React from 'react';\nimport { Tag, Select, Row, Col, Icon, Popover, Input, Dropdown, Divider } from 'antd';\nimport style from './Indicator.module.less';\nimport { IMetadataInfo, IMetadataListParam, IIndicatorInfo, IFieldInfo, IFilterInfo } from '@/api';\nimport { IPageData, IAction, IStoreState, IListData } from '@/types';\nimport { connect } from 'react-redux';\n\nimport { bindActionCreators, Dispatch } from 'redux';\nimport Filter from './Filter';\nconst { Option, OptGroup } = Select;\n\nconst { Search } = Input;\n\ninterface Props {\n  activeMetadataList: IPageData<IMetadataInfo>;\n  activeMetadataListParams: IMetadataListParam;\n  index?: number;\n  fieldList: IListData<IFieldInfo>;\n  indicators: IIndicatorInfo[];\n  onChange: (param: IIndicatorInfo[]) => any;\n  hasType?: boolean;\n  addText?: string;\n  hasCustomName?: boolean;\n}\n\nconst Indicator = ({\n  indicators,\n  activeMetadataList,\n  activeMetadataListParams,\n  onChange,\n  fieldList,\n  hasType,\n  addText = '+添加指标',\n  hasCustomName = false\n}: Props) => {\n  function handleSelectMetadata(info: IMetadataInfo, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].trackId = info.code;\n    newIndicators[index].metadataCode = info.code;\n    newIndicators[index].metadataName = info.name;\n    onChange(newIndicators);\n  }\n\n  function handleFilterChange(info: IFilterInfo, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].filter = info;\n    onChange(newIndicators);\n  }\n\n  function handleTypeChange(value: string, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].type = value;\n    onChange(newIndicators);\n  }\n\n  function handleNameChange(value: string, index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators[index].customName = value;\n    onChange(newIndicators);\n  }\n\n  function handleAdd() {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators.push({\n      trackId: null,\n      metadataCode: null,\n      metadataName: '所有事件',\n      type: 'SUM',\n      id: Date.now(),\n      filter: {\n        filterType: 'AND',\n        filterValues: []\n      }\n    });\n    onChange(newIndicators);\n  }\n\n  function handleRemove(index: number) {\n    const newIndicators: IIndicatorInfo[] = JSON.parse(JSON.stringify(indicators));\n    newIndicators.splice(index, 1);\n    onChange(newIndicators);\n  }\n\n  return (\n    <div className={style.wrapper}>\n      <div>\n        {indicators.map((indicatorInfo, index) => (\n          <div key={indicatorInfo.id}>\n            <Row className={style.item} gutter={10}>\n              <Col span={1}>\n                <div className={style.center}>\n                  <Tag color='gold'>{index + 1}</Tag>\n                </div>\n              </Col>\n              <Col span={3}>\n                <Dropdown\n                  overlay={\n                    <div className={style.content}>\n                      <div onClick={e => e.stopPropagation()}>\n                        <Search placeholder='搜索事件' onSearch={value => console.log(value)} style={{ width: 200 }} />\n                        <Select style={{ width: 200 }}>\n                          <Option value='1'>标签1</Option>\n                          <Option value='2'>标签2</Option>\n                          <Option value='3'>标签3</Option>\n                        </Select>\n                      </div>\n\n                      <div className={style.metadataBox}>\n                        {activeMetadataList.list.map(item => (\n                          <span\n                            onClick={() => handleSelectMetadata(item, index)}\n                            className='app-pointer'\n                            key={item.code}\n                          >\n                            {item.name}\n                          </span>\n                        ))}\n                      </div>\n                    </div>\n                  }\n                >\n                  <Input value={indicatorInfo.metadataName} readOnly className={style.select} />\n                </Dropdown>\n              </Col>\n              {hasCustomName && (\n                <Col span={3}>\n                  <Input\n                    defaultValue={indicatorInfo.customName}\n                    placeholder='自定义名称'\n                    onBlur={event => handleNameChange(event.target.value, index)}\n                  />\n                </Col>\n              )}\n              {hasType && (\n                <>\n                  <Col span={1}>\n                    <div className={style.center}>的</div>\n                  </Col>\n                  <Col span={3}>\n                    <Select onChange={(val: string) => handleTypeChange(val, index)} value={indicatorInfo.type}>\n                      <Option value='SUM'>总次数</Option>\n                      <Option value='USER_SUM'>用户数</Option>\n                      <Option value='3'>人均次数</Option>\n                    </Select>\n                  </Col>\n                </>\n              )}\n\n              {indicators.length > 1 && (\n                <Col span={1}>\n                  <div onClick={() => handleRemove(index)} className={'app-link ' + style.center}>\n                    <Icon type='close' />\n                  </div>\n                </Col>\n              )}\n            </Row>\n            <div className={style.filter}>\n              <Filter\n                fieldList={fieldList}\n                filterInfo={indicatorInfo.filter}\n                onChange={filter => handleFilterChange(filter, index)}\n              ></Filter>\n            </div>\n          </div>\n        ))}\n      </div>\n      <a onClick={handleAdd}>{addText}</a>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const { activeMetadataList, activeMetadataListParams } = state.metadata;\n  return {\n    activeMetadataList,\n    activeMetadataListParams\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) => bindActionCreators({}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Indicator);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Indicator_wrapper__3B5qd\",\"select\":\"Indicator_select__1kP-z\",\"content\":\"Indicator_content__3-BaR\",\"center\":\"Indicator_center__3Oax_\",\"metadataBox\":\"Indicator_metadataBox__3wnAQ\",\"active\":\"Indicator_active__1aD9o\",\"filter\":\"Indicator_filter__lBazH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Filter_wrapper__9rptJ\",\"line\":\"Filter_line__eOPS4\",\"type\":\"Filter_type__2GtXQ\",\"form\":\"Filter_form__1lfK0\",\"close\":\"Filter_close__1AZpi\"};","import * as React from 'react';\nimport { Select, Row, Col, Icon } from 'antd';\nimport style from './Dimension.module.less';\nimport { IFieldInfo } from '@/api';\nimport { IListData } from '@/types';\nconst { Option, OptGroup } = Select;\n\ninterface Props {\n  fieldList: IListData<IFieldInfo>;\n  dimension: string;\n  onChange: (param: string) => any;\n}\n\nconst Dimension = ({ fieldList, dimension, onChange }: Props) => {\n  return (\n    <div className={style.wrapper}>\n      <Row className={style.item}>\n        <Col span={1}>\n          <div className={style.center}>按</div>\n        </Col>\n        <Col span={3}>\n          <Select value={dimension} onChange={onChange}>\n            <Option value=''>总体</Option>\n            {fieldList.list.map(field => (\n              <Option value={field.value} key={field.value}>\n                {field.name}\n              </Option>\n            ))}\n          </Select>\n        </Col>\n        <Col span={1}>\n          <div className={style.center}>查看</div>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n\nexport default Dimension;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Dimension_wrapper__Ew76P\",\"center\":\"Dimension_center__1BCis\"};","import React from 'react';\nimport { Icon, Button, Input } from 'antd';\nimport { connect } from 'react-redux';\nimport { IAction, IStoreState } from '@/types';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doAddReport, doUpdateReport } from '@/store/actions';\nimport { IReportAddParam, IReportUpdateParam, IReportInfo } from '@/api';\nimport style from './AnalyseHeader.module.less';\ninterface Props {\n  reportInfo: IReportInfo;\n  handleAddReport: (params: IReportAddParam) => IAction;\n  handleUpdateReport: (params: IReportUpdateParam) => IAction;\n  data: Object;\n  //handleAppandBoard: (params: any) => IAction;\n}\nconst AnalyseHeader = ({ reportInfo, handleUpdateReport, handleAddReport, data }: Props) => {\n  const [newReportInfo, setnewReportInfo] = React.useState(reportInfo);\n  React.useEffect(() => {\n    setnewReportInfo(reportInfo);\n  }, [reportInfo]);\n\n  const handleSave = () => {\n    if (typeof reportInfo.id !== 'undefined') {\n      handleUpdateReport({ id: null, ...newReportInfo, data });\n    } else {\n      handleAddReport({ ...newReportInfo, data });\n    }\n  };\n\n  const handleSaveAs = () => {\n    handleAddReport({ ...newReportInfo, data });\n  };\n\n  const handleAppand = () => {\n    //handleAppandBoard(newReportInfo);\n  };\n\n  return (\n    <div className={style.wrapper}>\n      <h2 className={style.title}>\n        <Input\n          type='text'\n          onChange={e => setnewReportInfo({ ...newReportInfo, name: e.target.value })}\n          value={newReportInfo.name}\n        />\n      </h2>\n      <div className={style.btns}>\n        <Button type='link' icon='save' onClick={handleSave}>\n          保存\n        </Button>\n        {newReportInfo.id && (\n          <Button type='link' icon='save' onClick={handleSaveAs}>\n            另存为\n          </Button>\n        )}\n        <Button type='link' icon='plus-circle' onClick={handleAppand}>\n          添加到\n        </Button>\n      </div>\n      <div className={style.description}>\n        <Input\n          onChange={e => setnewReportInfo({ ...newReportInfo, description: e.target.value })}\n          value={newReportInfo.description}\n        ></Input>\n      </div>\n    </div>\n  );\n};\nconst mapStateToProps = (state: IStoreState) => {\n  const { reportInfo } = state.report;\n  return {\n    reportInfo\n  };\n};\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      handleAddReport: (params: IReportAddParam) => {\n        return doAddReport.request(params);\n      },\n      handleUpdateReport: (params: IReportUpdateParam) => {\n        return doUpdateReport.request(params);\n      }\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnalyseHeader);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"AnalyseHeader_wrapper__1r0g1\",\"btns\":\"AnalyseHeader_btns__G6iwS\",\"title\":\"AnalyseHeader_title__1X3LF\",\"description\":\"AnalyseHeader_description__1fJOY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ruleTitle\":\"AnalyseEvent_ruleTitle__3uJQg\",\"preview\":\"AnalyseEvent_preview__k46p_\"};","import { Icon, Collapse, Divider, Select, Input, Row, Col, Button, Spin } from 'antd';\nimport React from 'react';\nimport AnalyseRangePicker from '@/components/AnalyseRangePicker';\nimport moment from 'moment';\nimport style from './AnalyseEvent.module.less';\nimport ReactEcharts from 'echarts-for-react';\nimport Indicator from '@/components/Indicator';\nimport Dimension from '@/components/Dimension';\nimport Filter from '@/components/Filter';\nimport AnalyseHeader from './components/AnalyseHeader';\nimport { IReportInfo, IFieldInfo, IEventAnalyseData, IEventAnalyseParam } from '@/api';\nimport { connect } from 'react-redux';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doAddReport, doUpdateReport, doGetEventAnalyse } from '@/store/actions';\nimport { IAction, IStoreState, IListData, IDate } from '@/types';\nimport { DYNAMIC_TIME } from '@/constants';\nimport AnalyseEventChart from './components/AnalyseEventChart';\nconst { Option } = Select;\nconst { Panel } = Collapse;\nconst { Group } = Input;\ninterface Props {\n  fieldList: IListData<IFieldInfo>;\n  onGetEventAnalyseData: (param: IEventAnalyseParam) => IAction;\n  projectId: number;\n  eventAnalyseData: IEventAnalyseData;\n  eventAnalyseParam: IEventAnalyseParam;\n  analyseLoading: boolean;\n}\n\nconst AnalyseEvent = ({\n  analyseLoading,\n  fieldList,\n  onGetEventAnalyseData,\n  projectId,\n  eventAnalyseData,\n  eventAnalyseParam\n}: Props) => {\n  const handleChange = (info: IEventAnalyseParam) => {\n    info.projectId = projectId;\n    onGetEventAnalyseData(info);\n  };\n\n  return (\n    <div>\n      <AnalyseHeader data={{ ...eventAnalyseParam, projectId }}></AnalyseHeader>\n      <Collapse defaultActiveKey={['1']}>\n        <Panel header='添加分析规则' key='1'>\n          <div>\n            <div className={style.ruleTitle}>\n              <span>指标:</span>\n            </div>\n            <div>\n              <Indicator\n                hasType\n                fieldList={fieldList}\n                indicators={eventAnalyseParam.indicators}\n                onChange={indicators => handleChange({ ...eventAnalyseParam, indicators })}\n              />\n\n              {/* <Filter fieldList={fieldList} filterInfo={filter} /> */}\n            </div>\n          </div>\n\n          <div>\n            <div className={style.ruleTitle}>\n              <span>维度:</span>\n            </div>\n            <Dimension\n              dimension={eventAnalyseParam.dimension}\n              fieldList={fieldList}\n              onChange={dimension => handleChange({ ...eventAnalyseParam, dimension })}\n            />\n          </div>\n\n          <div>\n            <div className={style.ruleTitle}>\n              <span>筛选:</span>\n            </div>\n            <Filter\n              fieldList={fieldList}\n              filterInfo={eventAnalyseParam.filter}\n              onChange={filter => handleChange({ ...eventAnalyseParam, filter })}\n            />\n          </div>\n        </Panel>\n      </Collapse>\n\n      <div className={style.preview}>\n        <Row>\n          <Col span={14}>\n            <AnalyseRangePicker\n              pickerProps={{ allowClear: false }}\n              onChange={time => handleChange({ ...eventAnalyseParam, ...time })}\n              value={{\n                dateType: eventAnalyseParam.dateType,\n                dateEnd: eventAnalyseParam.dateEnd,\n                dateStart: eventAnalyseParam.dateStart\n              }}\n            />\n          </Col>\n          <Col span={6} offset={4}>\n            <Group compact>\n              <Select\n                style={{ width: '33%' }}\n                value={eventAnalyseParam.type}\n                onChange={(type: string) => handleChange({ ...eventAnalyseParam, type })}\n              >\n                <Option value='LINE'>折线图</Option>\n                <Option value='PIE'>饼图</Option>\n                <Option value='TABLE'>表格</Option>\n                <Option value='TEXT'>数值</Option>\n              </Select>\n              <Select\n                style={{ width: '33%' }}\n                value={eventAnalyseParam.timeUnit}\n                onChange={(timeUnit: string) => handleChange({ ...eventAnalyseParam, timeUnit })}\n              >\n                <Option value='HOUR'>按小时</Option>\n                <Option value='DAY'>按天</Option>\n                <Option value='WEEK'>按周</Option>\n                <Option value='MONTH'>按月</Option>\n                <Option value='YEAR'>按年</Option>\n              </Select>\n              <Button icon='download'>导出</Button>\n            </Group>\n          </Col>\n        </Row>\n        <Spin spinning={analyseLoading}>\n          <AnalyseEventChart data={eventAnalyseData}></AnalyseEventChart>\n        </Spin>\n        <div></div>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const { fieldList } = state.metadata;\n  const projectId = state.project.projectInfo.id;\n  const { eventAnalyseData, eventAnalyseParam, analyseLoading } = state.analyse;\n  return {\n    fieldList,\n    projectId,\n    eventAnalyseData,\n    eventAnalyseParam,\n    analyseLoading\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onGetEventAnalyseData: (param: IEventAnalyseParam) => doGetEventAnalyse.request(param)\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnalyseEvent);\n","import * as React from 'react';\nimport { Select, Row, Col, Icon, AutoComplete } from 'antd';\nimport style from './Filter.module.less';\nimport { IListData } from '@/types';\nimport { IFieldInfo, IFilterInfo, IFilterValue } from '@/api';\nimport { SelectValue } from 'antd/lib/select';\nconst { Option, OptGroup } = Select;\n\ninterface Props {\n  fieldList: IListData<IFieldInfo>;\n  filterInfo: IFilterInfo;\n  onChange: (filterInfo: IFilterInfo) => any;\n}\n\nconst Filter = ({ fieldList, filterInfo, onChange }: Props) => {\n  const [recommend, setrecommend] = React.useState<string[]>([]);\n  const handleFieldChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].key = value;\n    newFilterInfo.filterValues[index].type = 'equal';\n    newFilterInfo.filterValues[index].value = [];\n    const field = fieldList.list.find(field => field.value === value);\n    if (field) {\n      setrecommend(field.recommend);\n    }\n\n    onChange(newFilterInfo);\n  };\n\n  const handleFilterTypeChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].type = value;\n    if (value === 'equal' || value === 'notEqual') {\n      newFilterInfo.filterValues[index].value = [];\n    } else if (value === 'between') {\n      newFilterInfo.filterValues[index].value = [null, null];\n    } else {\n      newFilterInfo.filterValues[index].value = null;\n    }\n    onChange(newFilterInfo);\n  };\n\n  const handleFilterValueChange = (value: string, index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues[index].value = value;\n    onChange(newFilterInfo);\n  };\n\n  const handleClose = (index: number) => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues.splice(index, 1);\n    onChange(newFilterInfo);\n  };\n\n  const handleAdd = () => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterValues.push({\n      type: null,\n      key: null,\n      value: null,\n      id: Date.now()\n    });\n    onChange(newFilterInfo);\n  };\n\n  const handleChangeFilterType = () => {\n    const newFilterInfo: IFilterInfo = JSON.parse(JSON.stringify(filterInfo));\n    newFilterInfo.filterType = newFilterInfo.filterType === 'AND' ? 'OR' : 'AND';\n    onChange(newFilterInfo);\n  };\n\n  return (\n    <div>\n      {filterInfo.filterValues.length > 0 && (\n        <div className={style.wrapper}>\n          {filterInfo.filterValues.length > 1 && (\n            <div className={style.type}>\n              <button onClick={handleChangeFilterType}>{filterInfo.filterType === 'AND' ? '且' : '或'}</button>\n              <div className={style.line}></div>\n            </div>\n          )}\n          <div className={style.form}>\n            {filterInfo.filterValues.map((filter, index) => (\n              <Row gutter={16} key={filter.id}>\n                <Col span={3}>\n                  <Select value={filter.key} onChange={(val: string) => handleFieldChange(val, index)}>\n                    {fieldList.list.map(field => (\n                      <Option value={field.value} key={field.value}>\n                        {field.name}\n                      </Option>\n                    ))}\n                  </Select>\n                </Col>\n                <Col span={3}>\n                  <Select value={filter.type} onChange={(val: string) => handleFilterTypeChange(val, index)}>\n                    <Option value='equal'>等于</Option>\n                    <Option value='notEqual'>不等于</Option>\n                    <Option value='isSet'>有值</Option>\n                    <Option value='notSet'>没值</Option>\n\n                    <Option value='greater'>大于</Option>\n                    <Option value='less'>小于</Option>\n                    <Option value='between'>区间</Option>\n\n                    <Option value='contain'>包含</Option>\n                    <Option value='notContain'>不包含</Option>\n                    <Option value='isEmpty'>为空</Option>\n                    <Option value='isNotEmpty'>不为空</Option>\n                    <Option value='rlike'>正则匹配</Option>\n                    <Option value='notrlike'>正则不匹配</Option>\n                  </Select>\n                </Col>\n                {filter.type !== 'isEmpty' &&\n                  filter.type !== 'isNotEmpty' &&\n                  filter.type !== 'isSet' &&\n                  filter.type !== 'notSet' &&\n                  filter.type !== 'rlike' &&\n                  filter.type !== 'notrlike' && (\n                    <Col span={8}>\n                      {filter.type === 'equal' || filter.type === 'notEqual' ? (\n                        <Select\n                          value={filter.value}\n                          onChange={(val: string) => handleFilterValueChange(val, index)}\n                          mode='tags'\n                          style={{ width: '100%' }}\n                          tokenSeparators={[',']}\n                        >\n                          {recommend.map(item => (\n                            <Option key={item} value={item}>\n                              {item}\n                            </Option>\n                          ))}\n                        </Select>\n                      ) : (\n                        <AutoComplete\n                          value={filter.value}\n                          dataSource={recommend}\n                          style={{ width: '100%' }}\n                          onChange={(val: any) => handleFilterValueChange(val, index)}\n                        />\n                      )}\n                    </Col>\n                  )}\n                <Col span={1}>\n                  <div onClick={() => handleClose(index)} className={'app-link ' + style.close}>\n                    <Icon type='close' />\n                  </div>\n                </Col>\n              </Row>\n            ))}\n          </div>\n        </div>\n      )}\n      <a onClick={handleAdd}>+添加筛选</a>\n    </div>\n  );\n};\n\nexport default Filter;\n"],"sourceRoot":""}