(window["webpackJsonptracker-web"]=window["webpackJsonptracker-web"]||[]).push([[24],{1408:function(e,t,n){e.exports={wrapper:"RoleMange_wrapper__2s0pB",header:"RoleMange_header__1Z6q6",listBox:"RoleMange_listBox__o6LWe",table:"RoleMange_table__2NWsA",submitButtons:"RoleMange_submitButtons__2qCQz",rightBtn:"RoleMange_rightBtn__3LBlU"}},1432:function(e,t,n){"use strict";n.r(t);var r=n(46),a=n(7),o=n.n(a),l=n(1093),i=n(84),c=n(0),u=n.n(c),s=n(63),m=n(66),p=n(5),d=n(9),f=n(74),b=n(1129),O=n(1086),E=n(1087),y=n(1091),g=n(1089),v=n(1085),I=n(208),R=n(1092),j=n(8),h=n(1103),P=n.n(h),w=I.a.Option,k=Object(s.c)((function(e){var t=e.role;return{addRoleItem:t.addRoleItem,updateRoleItem:t.updateRoleItem}}),(function(e){return Object(m.b)({onAddRole:function(e){return p.bb.request(e)}},e)}))(y.a.create()((function(e){var t=e.form.getFieldDecorator;c.useEffect((function(){e.form.resetFields()}),[e.visible]);return c.createElement(R.a,{onOk:function(t){t.preventDefault(),e.form.validateFields(function(){var t=Object(l.a)(o.a.mark((function t(n,r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=3;break}return Object(j.v)(n),t.abrupt("return");case 3:r.name=Object(j.w)(r.name),r.code=Object(j.w)(r.code.toLocaleUpperCase()),e.onAddRole(r),e.onClose(!1);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},title:"\u65b0\u5efa\u89d2\u8272",visible:e.visible,onCancel:function(){return e.onClose(!1)}},c.createElement(y.a,Object.assign({layout:"horizontal"},d.gb),c.createElement(y.a.Item,{label:"\u89d2\u8272\u540d"},t("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],initialValue:e.addRoleItem.name})(c.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}))),c.createElement(y.a.Item,{label:"\u89d2\u8272\u7801"},t("code",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u7801"}],initialValue:e.addRoleItem.code})(c.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u7801"}))),c.createElement(y.a.Item,{label:"\u89d2\u8272\u7c7b\u578b"},t("type",{rules:[{required:!0,message:"\u89d2\u8272\u7c7b\u578b"}],initialValue:e.addRoleItem.type})(c.createElement(I.a,{placeholder:"\u8bf7\u9009\u62e9"},d.ib.map((function(e){return c.createElement(w,{key:e.id,value:e.id},e.name)}))))),c.createElement(y.a.Item,Object.assign({},d.gb,{label:"\u89d2\u8272\u63cf\u8ff0"}),t("description",{initialValue:e.addRoleItem.description})(c.createElement(P.a,{style:{minHeight:32},placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0",rows:4})))))}))),C=n(1408),L=n.n(C);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S,D=I.a.Option,x=Object(s.c)((function(e){return{updateRoleItem:e.role.updateRoleItem}}),(function(e){return Object(m.b)({onPutRole:function(e){return p.db.request(e)}},e)}))(y.a.create()((function(e){var t=e.form.getFieldDecorator;c.useEffect((function(){e.form.resetFields()}),[e.visible]);return c.createElement(R.a,{onOk:function(t){t.preventDefault(),e.form.validateFields(function(){var t=Object(l.a)(o.a.mark((function t(n,r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=3;break}return Object(j.v)(n),t.abrupt("return");case 3:e.onPutRole(N({},e.updateRoleItem,{},r)),e.onClose(!1);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},title:"\u65b0\u5efa\u89d2\u8272",visible:e.visible,onCancel:function(){return e.onClose(!1)}},c.createElement(y.a,Object.assign({layout:"horizontal"},d.gb),c.createElement(y.a.Item,{label:"\u89d2\u8272\u540d"},t("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],initialValue:e.updateRoleItem.name})(c.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d",disabled:!0}))),c.createElement(y.a.Item,{label:"\u89d2\u8272\u7801"},t("code",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u7801"}],initialValue:e.updateRoleItem.code})(c.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u7801",disabled:!0}))),c.createElement(y.a.Item,{label:"\u89d2\u8272\u7c7b\u578b"},t("type",{rules:[{required:!0,message:"\u89d2\u8272\u7c7b\u578b"}],initialValue:e.updateRoleItem.type})(c.createElement(I.a,{placeholder:"\u8bf7\u9009\u62e9",disabled:!0},d.ib.map((function(e){return c.createElement(D,{key:e.id,value:e.id},e.name)}))))),c.createElement(y.a.Item,Object.assign({},d.gb,{label:"\u89d2\u8272\u63cf\u8ff0"}),t("description",{initialValue:e.updateRoleItem.description})(c.createElement(P.a,{style:{minHeight:32},placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0",rows:4})))))}))),q=n(181);!function(e){e[e.API=1]="API",e[e.ROUTER=2]="ROUTER",e[e.FUNCTION=3]="FUNCTION"}(S||(S={}));var F=Object(s.c)((function(e){return{allPermissionList:e.permission.allPermissionList,roleInfo:e.role.roleInfo}}),(function(e){return Object(m.b)({onPutRolePermissions:function(e){return p.ob.request(e)}},e)}))((function(e){var t=c.useState(null),n=Object(i.a)(t,2),r=n[0],a=n[1],u=c.useState(null),s=Object(i.a)(u,2),m=s[0],p=s[1],d=c.useState(null),f=Object(i.a)(d,2),b=f[0],O=f[1],E=e.allPermissionList.list.map((function(e){return{label:e.name,value:e.id,disabled:!e.status,type:e.type}})),y=E.filter((function(e){return e.type===S.API})),g=E.filter((function(e){return e.type===S.ROUTER})),v=E.filter((function(e){return e.type===S.FUNCTION}));c.useEffect((function(){a(e.roleInfo.permissions.filter((function(e){return e.type===S.API})).map((function(e){return e.id}))),p(e.roleInfo.permissions.filter((function(e){return e.type===S.ROUTER})).map((function(e){return e.id}))),O(e.roleInfo.permissions.filter((function(e){return e.type===S.FUNCTION})).map((function(e){return e.id})))}),[e.roleInfo,e.allPermissionList]);var I=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onPutRolePermissions({roleId:e.roleId,permissionIds:r.concat(m).concat(b)});case 2:e.onClose(!1);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e){return function(t){e===S.API?a(t):e===S.ROUTER?p(t):O(t)}};return c.createElement(R.a,{onOk:I,title:"\u5173\u8054\u6743\u9650",visible:e.visible,onCancel:function(){return e.onClose(!1)}},c.createElement("h4",null,"\u63a5\u53e3\u7c7b\u578b\u6743\u9650"),c.createElement(q.a.Group,{options:y,value:r,onChange:j(S.API)}),c.createElement("h4",null,"\u8def\u7531\u7c7b\u578b\u6743\u9650"),c.createElement(q.a.Group,{options:g,value:m,onChange:j(S.ROUTER)}),c.createElement("h4",null,"\u529f\u80fd\u7c7b\u578b\u6743\u9650"),c.createElement(q.a.Group,{options:v,value:b,onChange:j(S.FUNCTION)}))}));function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.default=Object(s.c)((function(e){var t=e.role;return{addRoleItem:t.addRoleItem,updateRoleItem:t.updateRoleItem,roleList:t.roleList,roleListParams:t.roleListParams}}),(function(e){return Object(m.b)({onGetRoleList:function(e){return p.R.request(e)},onDeleteRole:function(e){return p.u.request(e)},onEditRole:function(e){return Object(p.z)(e)},onGetRolePermissions:function(e){return p.S.request(e)}},e)}))(y.a.create()((function(e){var t=e.form.getFieldDecorator,n=u.a.useState(!1),a=Object(i.a)(n,2),c=a[0],s=a[1],m=u.a.useState(!1),p=Object(i.a)(m,2),I=p[0],R=p[1],h=u.a.useState(!1),P=Object(i.a)(h,2),w=P[0],C=P[1],_=u.a.useState(null),N=Object(i.a)(_,2),S=N[0],D=N[1],q=[{key:"name",title:"\u89d2\u8272\u540d",dataIndex:"name"},{key:"code",title:"\u89d2\u8272\u7801",dataIndex:"code"},{key:"type",title:"\u89d2\u8272\u7c7b\u578b",render:function(e,t){return u.a.createElement("span",null,d.ib.find((function(e){return e.id===t.type})).name)}},{key:"description",title:"\u63cf\u8ff0",dataIndex:"description"},{key:"updaterNickname",title:"\u6700\u540e\u66f4\u65b0\u4eba",dataIndex:"updaterNickname"},{key:"action",title:"\u64cd\u4f5c",width:280,render:function(t,n){return u.a.createElement("span",null,u.a.createElement(f.a,{type:"link",size:"small",onClick:Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onGetRolePermissions(n.id);case 2:D(n.id),C(!0);case 4:case"end":return t.stop()}}),t)})))},"\u5173\u8054\u6743\u9650"),u.a.createElement(f.a,{type:"link",size:"small",onClick:function(){e.onEditRole(n),R(!0)}},"\u7f16\u8f91"),u.a.createElement(b.a,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return e.onDeleteRole(n.id)}},u.a.createElement(f.a,{type:"link",size:"small"},"\u5220\u9664")))}}];return u.a.createElement("div",{className:L.a.wrapper},u.a.createElement(O.a,{gutter:24},u.a.createElement(E.a,null,u.a.createElement(O.a,null,u.a.createElement(y.a,Object.assign({layout:"horizontal"},d.gb),u.a.createElement(E.a,{span:6},u.a.createElement(y.a.Item,{label:"\u89d2\u8272\u540d/\u7801"},t("name",{initialValue:e.roleListParams.name})(u.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d/\u89d2\u8272\u7801"}))))),u.a.createElement(E.a,{span:4},u.a.createElement("span",{className:L.a.submitButtons},u.a.createElement(f.a,{type:"primary",onClick:function(t){t.preventDefault(),e.form.validateFields((function(t,n){t?Object(j.v)(t):(n.name=Object(j.w)(n.name),e.onGetRoleList(n))}))}},"\u67e5\u8be2"))),u.a.createElement(E.a,{span:14},u.a.createElement(k,{visible:c,onClose:s}),u.a.createElement(x,{visible:I,onClose:R}),u.a.createElement(F,{roleId:S,visible:w,onClose:C}),u.a.createElement("div",{className:L.a.rightBtn},u.a.createElement(f.a,{type:"primary",onClick:function(){return s(!0)}},"\u65b0\u5efa\u89d2\u8272")))))),u.a.createElement("div",{className:L.a.table},u.a.createElement(v.a,{rowKey:"id",columns:q,dataSource:e.roleList.list,pagination:{pageSize:e.roleListParams.pageSize,total:e.roleList.totalCount,current:e.roleListParams.page},onChange:function(t){e.onGetRoleList(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.form.getFieldsValue(),{page:t.current,pageSize:t.pageSize}))}})))})))}}]);
//# sourceMappingURL=24.46ce1159.chunk.js.map