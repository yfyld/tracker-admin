(window["webpackJsonptracker-web"]=window["webpackJsonptracker-web"]||[]).push([[8],{1002:function(e,t,a){"use strict";var n=a(0),r=a(187),l=a(993),c=a(1e3),i=a(1001),o=a(477),u=a(236),s=a(21),m=a(1003),p=a.n(m),d=a(65),f=a(62),v=a(999),E=r.a.Option,y=(r.a.OptGroup,l.a.Search);t.a=Object(d.c)((function(e){var t=e.metadata;return{activeMetadataList:t.activeMetadataList,activeMetadataListParams:t.activeMetadataListParams}}),(function(e){return Object(f.b)({},e)}))((function(e){var t=e.indicators,a=e.activeMetadataList,m=(e.activeMetadataListParams,e.onChange),d=e.fieldList,f=e.hasType,O=e.addText,g=void 0===O?"+\u6dfb\u52a0\u6307\u6807":O,h=e.hasCustomName,_=void 0!==h&&h;function N(e,a){var n=JSON.parse(JSON.stringify(t));n[a].filter=e,m(n)}function b(e,a){var n=JSON.parse(JSON.stringify(t));n[a].type=e,m(n)}return n.createElement("div",{className:p.a.wrapper},n.createElement("div",null,t.map((function(e,O){return n.createElement("div",{key:e.id},n.createElement(c.a,{className:p.a.item,gutter:10},n.createElement(i.a,{span:1},n.createElement("div",{className:p.a.center},n.createElement(o.a,{color:"gold"},O+1))),n.createElement(i.a,{span:3},n.createElement(u.a,{overlay:n.createElement("div",{className:p.a.content},n.createElement("div",{onClick:function(e){return e.stopPropagation()}},n.createElement(y,{placeholder:"\u641c\u7d22\u4e8b\u4ef6",onSearch:function(e){return console.log(e)},style:{width:200}}),n.createElement(r.a,{style:{width:200}},n.createElement(E,{value:"1"},"\u6807\u7b7e1"),n.createElement(E,{value:"2"},"\u6807\u7b7e2"),n.createElement(E,{value:"3"},"\u6807\u7b7e3"))),n.createElement("div",{className:p.a.metadataBox},a.list.map((function(e){return n.createElement("span",{onClick:function(){return function(e,a){var n=JSON.parse(JSON.stringify(t));n[a].trackId=e.code,n[a].metadataCode=e.code,n[a].metadataName=e.name,m(n)}(e,O)},className:"app-pointer",key:e.code},e.name)}))))},n.createElement(l.a,{value:e.metadataName,readOnly:!0,className:p.a.select}))),_&&n.createElement(i.a,{span:3},n.createElement(l.a,{defaultValue:e.customName,placeholder:"\u81ea\u5b9a\u4e49\u540d\u79f0",onBlur:function(e){return function(e,a){var n=JSON.parse(JSON.stringify(t));n[a].customName=e,m(n)}(e.target.value,O)}})),f&&n.createElement(n.Fragment,null,n.createElement(i.a,{span:1},n.createElement("div",{className:p.a.center},"\u7684")),n.createElement(i.a,{span:3},n.createElement(r.a,{onChange:function(e){return b(e,O)},value:e.type},n.createElement(E,{value:"SUM"},"\u603b\u6b21\u6570"),n.createElement(E,{value:"USER_SUM"},"\u7528\u6237\u6570"),n.createElement(E,{value:"3"},"\u4eba\u5747\u6b21\u6570")))),t.length>1&&n.createElement(i.a,{span:1},n.createElement("div",{onClick:function(){return function(e){var a=JSON.parse(JSON.stringify(t));a.splice(e,1),m(a)}(O)},className:"app-link "+p.a.center},n.createElement(s.a,{type:"close"})))),n.createElement("div",{className:p.a.filter},n.createElement(v.a,{fieldList:d,filterInfo:e.filter,onChange:function(e){return N(e,O)}})))}))),n.createElement("a",{onClick:function(){var e=JSON.parse(JSON.stringify(t));e.push({trackId:null,metadataCode:null,metadataName:"\u6240\u6709\u4e8b\u4ef6",type:"SUM",id:Date.now(),filter:{filterType:"AND",filterValues:[]}}),m(e)}},g))}))},1003:function(e,t,a){e.exports={wrapper:"Indicator_wrapper__3B5qd",select:"Indicator_select__1kP-z",content:"Indicator_content__3-BaR",center:"Indicator_center__3Oax_",metadataBox:"Indicator_metadataBox__3wnAQ",active:"Indicator_active__1aD9o",filter:"Indicator_filter__lBazH"}},1004:function(e,t,a){e.exports={wrapper:"Filter_wrapper__9rptJ",line:"Filter_line__eOPS4",type:"Filter_type__2GtXQ",form:"Filter_form__1lfK0",close:"Filter_close__1AZpi"}},1005:function(e,t,a){"use strict";var n=a(0),r=a(187),l=a(1e3),c=a(1001),i=a(1006),o=a.n(i),u=r.a.Option;r.a.OptGroup;t.a=function(e){var t=e.fieldList,a=e.dimension,i=e.onChange;return n.createElement("div",{className:o.a.wrapper},n.createElement(l.a,{className:o.a.item},n.createElement(c.a,{span:1},n.createElement("div",{className:o.a.center},"\u6309")),n.createElement(c.a,{span:3},n.createElement(r.a,{value:a,onChange:i},n.createElement(u,{value:""},"\u603b\u4f53"),t.list.map((function(e){return n.createElement(u,{value:e.value,key:e.value},e.name)})))),n.createElement(c.a,{span:1},n.createElement("div",{className:o.a.center},"\u67e5\u770b"))))}},1006:function(e,t,a){e.exports={wrapper:"Dimension_wrapper__Ew76P",center:"Dimension_center__1BCis"}},1007:function(e,t,a){"use strict";var n=a(56),r=a(103),l=a(0),c=a.n(l),i=a(993),o=a(68),u=a(65),s=a(62),m=a(6),p=a(1008),d=a.n(p);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a=Object(u.c)((function(e){return{reportInfo:e.report.reportInfo}}),(function(e){return Object(s.b)({handleAddReport:function(e){return m.d.request(e)},handleUpdateReport:function(e){return m.O.request(e)}},e)}))((function(e){var t=e.reportInfo,a=e.handleUpdateReport,n=e.handleAddReport,l=e.data,u=c.a.useState(t),s=Object(r.a)(u,2),m=s[0],p=s[1];c.a.useEffect((function(){p(t)}),[t]);return c.a.createElement("div",{className:d.a.wrapper},c.a.createElement("h2",{className:d.a.title},c.a.createElement(i.a,{type:"text",onChange:function(e){return p(v({},m,{name:e.target.value}))},value:m.name})),c.a.createElement("div",{className:d.a.btns},c.a.createElement(o.a,{type:"link",icon:"save",onClick:function(){"undefined"!==typeof t.id?a(v({id:null},m,{data:l})):n(v({},m,{data:l}))}},"\u4fdd\u5b58"),m.id&&c.a.createElement(o.a,{type:"link",icon:"save",onClick:function(){n(v({},m,{data:l}))}},"\u53e6\u5b58\u4e3a"),c.a.createElement(o.a,{type:"link",icon:"plus-circle",onClick:function(){}},"\u6dfb\u52a0\u5230")),c.a.createElement("div",{className:d.a.description},c.a.createElement(i.a,{onChange:function(e){return p(v({},m,{description:e.target.value}))},value:m.description})))}))},1008:function(e,t,a){e.exports={wrapper:"AnalyseHeader_wrapper__1r0g1",btns:"AnalyseHeader_btns__G6iwS",title:"AnalyseHeader_title__1X3LF",description:"AnalyseHeader_description__1fJOY"}},1022:function(e,t,a){e.exports={ruleTitle:"AnalyseFunnel_ruleTitle__3gwQF",preview:"AnalyseFunnel_preview__18PLM"}},1048:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a(187),l=a(1041),c=a(993),i=a(1e3),o=a(1001),u=a(68),s=a(319),m=a(0),p=a.n(m),d=a(316),f=a(1022),v=a.n(f),E=a(1002),y=a(1005),O=a(999),g=a(1007),h=a(65),_=a(62),N=a(6),b=a(318),w=a.n(b),k=a(992),S=a(23),j=a.n(S),P=a(8),D=a(103),C=function(e,t){var a={grid:{bottom:60,top:20},tooltip:{trigger:"axis"},legend:{show:!0,bottom:0},xAxis:{type:"time",axisLine:{lineStyle:{color:"#999"}}},yAxis:{type:"value",minInterval:1,splitLine:{lineStyle:{type:"dashed",color:"#DDD"}},axisLine:{show:!1,lineStyle:{color:"#333"}},nameTextStyle:{color:"#999"},splitArea:{show:!1}},series:[]};return e.list.forEach((function(e){a.series.push({type:"line",name:e.dimension,data:e.data.map((function(e){return{name:e.time,value:[e.time,e.conversionRateMap[t]]}}))})})),a},L=function(e){var t=e.data,a=m.useState("_ALL"),n=Object(D.a)(a,2),r=n[0],l=n[1];return!!t.list.find((function(e){return e.data.length>0}))?m.createElement("div",null,m.createElement("div",null,t.list[0].allData.map((function(e,a){return m.createElement("div",{key:e.key},0===a?m.createElement("span",{onClick:function(){return l("_ALL")}},"\u603b\u8f6c\u5316\u7387:",t.conversionRate,"%"):m.createElement("span",{onClick:function(){return l(e.key)}},"\u8f6c\u5316\u7387:",e.conversionRate,"%"),m.createElement("p",null,e.customName||e.metadataName,"(",e.count,")"))}))),m.createElement(w.a,{option:C(t,r),theme:"ts",notMerge:!0,lazyUpdate:!0})):m.createElement("div",null,"\u6682\u65e0\u6570\u636e")};function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x=function(e){return{tooltip:{show:!0},series:[{type:"funnel",left:"10%",top:60,bottom:60,width:"80%",minSize:"0%",maxSize:"100%",sort:"none",gap:2,label:{show:!0,position:"inside",formatter:function(e){return"".concat(e.name,"(").concat(e.value,")")}},emphasis:{label:{fontSize:20}},data:e.list[0].allData.map((function(e){return{name:e.customName||e.metadataName,value:e.count}}))}]}},I=function(e){return e.list.map((function(e){return J({key:e.dimension,time:e.dimension},e.allData.reduce((function(e,t){return e[t.key+"_count"]=t.count,e[t.key+"_rate"]=t.conversionRate,e}),{}),{children:e.data.map((function(e){return J({key:e.time,time:e.time},e.steps.reduce((function(e,t){return e[t.key+"_count"]=t.count,e[t.key+"_rate"]=t.conversionRate,e}),{}))}))})}))},T=function(e){var t=e.data;if(!!!t.list.find((function(e){return e.allData.length>0})))return m.createElement("div",null,"\u6682\u65e0\u6570\u636e");switch(t.type){case"TABLE":var a=function(e){var t=[{title:"",key:"time",dataIndex:"time",fixed:"left",width:200,defaultSortOrder:"descend",sorter:function(e,t){return new Date(e.time).getTime()-new Date(t.time).getTime()},render:function(t){return/\d/.test(t)?j()(t).format(Object(P.c)(e.timeUnit)):t}}];return e.list[0].allData.forEach((function(e,a){0===a?t.push({title:"\u603b\u8f6c\u5316\u7387",key:e.key,dataIndex:e.key+"_count",render:function(t,a){return m.createElement("div",null,a[e.key+"_count"]," ",m.createElement("span",null,"(",a[e.key+"_rate"],")"))}}):t.push({title:"\u7b2c\u4e00\u6b65(".concat(e.customName||e.metadataName,")"),key:e.key,dataIndex:e.key+"_count",render:function(t,a){return m.createElement("div",null,a[e.key+"_count"]," ",m.createElement("span",null,"(",a[e.key+"_rate"],")"))}})})),t}(t),n=a.length>5?{x:200*a.length}:{};return m.createElement("div",null,m.createElement(k.a,{columns:a,dataSource:I(t),scroll:n}));case"LIST":return m.createElement("div",null,m.createElement(L,{data:t}));default:return m.createElement("div",null,m.createElement(w.a,{option:x(t),theme:"ts",notMerge:!0,lazyUpdate:!0}))}};function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var M=r.a.Option,R=l.a.Panel,U=c.a.Group;t.default=Object(h.c)((function(e){var t=e.metadata.fieldList,a=e.project.projectInfo.id,n=e.analyse;return{fieldList:t,projectId:a,funnelAnalyseData:n.funnelAnalyseData,funnelAnalyseParam:n.funnelAnalyseParam,analyseLoading:n.analyseLoading}}),(function(e){return Object(_.b)({onGetFunnelAnalyseData:function(e){return N.x.request(e)}},e)}))((function(e){var t=e.analyseLoading,a=e.fieldList,n=e.onGetFunnelAnalyseData,c=e.projectId,m=e.funnelAnalyseData,f=e.funnelAnalyseParam,h=function(e){e.projectId=c,n(e)};return p.a.createElement("div",null,p.a.createElement(g.a,{data:F({},f,{projectId:c})}),p.a.createElement(l.a,{defaultActiveKey:["1"]},p.a.createElement(R,{header:"\u6dfb\u52a0\u6f0f\u6597\u5206\u6790\u89c4\u5219",key:"1"},p.a.createElement("div",null,p.a.createElement("div",{className:v.a.ruleTitle},p.a.createElement("span",null,"\u6307\u6807:")),p.a.createElement(r.a,{value:f.indicatorType,onChange:function(e){return h(F({},f,{indicatorType:e}))}},p.a.createElement(M,{value:"PV"},"\u603b\u6570"),p.a.createElement(M,{value:"UV"}," \u7528\u6237\u6570"),p.a.createElement(M,{value:"APV"},"\u4eba\u5747\u6b21\u6570"),p.a.createElement(M,{value:"DPV"},"\u65e5\u5747\u6b21\u6570"),p.a.createElement(M,{value:"DUV"},"\u65e5\u5747\u7528\u6237\u6570"))),p.a.createElement("div",null,p.a.createElement("div",{className:v.a.ruleTitle},p.a.createElement("span",null,"\u7ef4\u5ea6:")),p.a.createElement(y.a,{dimension:f.dimension,fieldList:a,onChange:function(e){return h(F({},f,{dimension:e}))}})),p.a.createElement("div",null,p.a.createElement("div",{className:v.a.ruleTitle},p.a.createElement("span",null,"\u7b5b\u9009:")),p.a.createElement(O.a,{fieldList:a,filterInfo:f.filter,onChange:function(e){return h(F({},f,{filter:e}))}})),p.a.createElement("div",null,p.a.createElement("div",{className:v.a.ruleTitle},p.a.createElement("span",null,"\u6f0f\u6597\u6b65\u9aa4:")),p.a.createElement(E.a,{addText:"+\u6dfb\u52a0\u6b65\u9aa4",hasCustomName:!0,fieldList:a,indicators:f.indicators,onChange:function(e){return h(F({},f,{indicators:e}))}})))),p.a.createElement("div",{className:v.a.preview},p.a.createElement(i.a,null,p.a.createElement(o.a,{span:14},p.a.createElement(d.a,{onChange:function(e){return h(F({},f,{},e))},value:{dateType:f.dateType,dateEnd:f.dateEnd,dateStart:f.dateStart}})),p.a.createElement(o.a,{span:6,offset:4},p.a.createElement(U,{compact:!0},p.a.createElement(r.a,{style:{width:"33%"},value:f.type,onChange:function(e){return h(F({},f,{type:e}))}},p.a.createElement(M,{value:"FUNNEL"},"\u6f0f\u6597\u56fe"),p.a.createElement(M,{value:"LIST"},"\u5217\u8868"),p.a.createElement(M,{value:"TABLE"},"\u8868\u683c")),p.a.createElement(u.a,{icon:"download"},"\u5bfc\u51fa")))),p.a.createElement(s.a,{spinning:t},p.a.createElement(T,{data:m})),p.a.createElement("div",null)))}))},999:function(e,t,a){"use strict";var n=a(103),r=a(0),l=a(187),c=a(1e3),i=a(1001),o=a(1050),u=a(21),s=a(1004),m=a.n(s),p=l.a.Option;l.a.OptGroup;t.a=function(e){var t=e.fieldList,a=e.filterInfo,s=e.onChange,d=r.useState([]),f=Object(n.a)(d,2),v=f[0],E=f[1],y=function(e,n){var r=JSON.parse(JSON.stringify(a));r.filterValues[n].key=e,r.filterValues[n].type="equal",r.filterValues[n].value=[];var l=t.list.find((function(t){return t.value===e}));l&&E(l.recommend),s(r)},O=function(e,t){var n=JSON.parse(JSON.stringify(a));n.filterValues[t].type=e,n.filterValues[t].value="equal"===e||"notEqual"===e?[]:"between"===e?[null,null]:null,s(n)},g=function(e,t){var n=JSON.parse(JSON.stringify(a));n.filterValues[t].value=e,s(n)};return r.createElement("div",null,a.filterValues.length>0&&r.createElement("div",{className:m.a.wrapper},a.filterValues.length>1&&r.createElement("div",{className:m.a.type},r.createElement("button",{onClick:function(){var e=JSON.parse(JSON.stringify(a));e.filterType="AND"===e.filterType?"OR":"AND",s(e)}},"AND"===a.filterType?"\u4e14":"\u6216"),r.createElement("div",{className:m.a.line})),r.createElement("div",{className:m.a.form},a.filterValues.map((function(e,n){return r.createElement(c.a,{gutter:16,key:e.id},r.createElement(i.a,{span:3},r.createElement(l.a,{value:e.key,onChange:function(e){return y(e,n)}},t.list.map((function(e){return r.createElement(p,{value:e.value,key:e.value},e.name)})))),r.createElement(i.a,{span:3},r.createElement(l.a,{value:e.type,onChange:function(e){return O(e,n)}},r.createElement(p,{value:"equal"},"\u7b49\u4e8e"),r.createElement(p,{value:"notEqual"},"\u4e0d\u7b49\u4e8e"),r.createElement(p,{value:"isSet"},"\u6709\u503c"),r.createElement(p,{value:"notSet"},"\u6ca1\u503c"),r.createElement(p,{value:"greater"},"\u5927\u4e8e"),r.createElement(p,{value:"less"},"\u5c0f\u4e8e"),r.createElement(p,{value:"between"},"\u533a\u95f4"),r.createElement(p,{value:"contain"},"\u5305\u542b"),r.createElement(p,{value:"notContain"},"\u4e0d\u5305\u542b"),r.createElement(p,{value:"isEmpty"},"\u4e3a\u7a7a"),r.createElement(p,{value:"isNotEmpty"},"\u4e0d\u4e3a\u7a7a"),r.createElement(p,{value:"rlike"},"\u6b63\u5219\u5339\u914d"),r.createElement(p,{value:"notrlike"},"\u6b63\u5219\u4e0d\u5339\u914d"))),"isEmpty"!==e.type&&"isNotEmpty"!==e.type&&"isSet"!==e.type&&"notSet"!==e.type&&"rlike"!==e.type&&"notrlike"!==e.type&&r.createElement(i.a,{span:8},"equal"===e.type||"notEqual"===e.type?r.createElement(l.a,{value:e.value,onChange:function(e){return g(e,n)},mode:"tags",style:{width:"100%"},tokenSeparators:[","]},v.map((function(e){return r.createElement(p,{key:e,value:e},e)}))):r.createElement(o.a,{value:e.value,dataSource:v,style:{width:"100%"},onChange:function(e){return g(e,n)}})),r.createElement(i.a,{span:1},r.createElement("div",{onClick:function(){return function(e){var t=JSON.parse(JSON.stringify(a));t.filterValues.splice(e,1),s(t)}(n)},className:"app-link "+m.a.close},r.createElement(u.a,{type:"close"}))))})))),r.createElement("a",{onClick:function(){var e=JSON.parse(JSON.stringify(a));e.filterValues.push({type:null,key:null,value:null,id:Date.now()}),s(e)}},"+\u6dfb\u52a0\u7b5b\u9009"))}}}]);
//# sourceMappingURL=8.c108ea5b.chunk.js.map