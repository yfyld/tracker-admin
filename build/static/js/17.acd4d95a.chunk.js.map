{"version":3,"sources":["pages/metadata/MetadataList.module.less","pages/metadata/components/TagManagement.module.less","pages/metadata/components/MetadataAddModal.tsx","pages/metadata/components/MetadataEditModal.tsx","pages/metadata/components/TagAddModal.tsx","pages/metadata/components/TagEditModal.tsx","pages/metadata/components/TagManagement.tsx","pages/metadata/components/MetadataListForm.tsx","pages/metadata/MetadataList.tsx"],"names":["module","exports","connect","state","projectId","project","projectInfo","id","tagList","metadata","dispatch","bindActionCreators","onAddMetadata","params","doAddMetadata","request","Form","create","props","getFieldDecorator","form","Option","Select","TextArea","Input","React","resetFields","visible","onOk","e","preventDefault","validateFields","err","values","toastformError","newTags","newTagsTemp","tags","forEach","item","test","push","parseInt","status","log","onClose","title","onCancel","layout","formItemLayout","Item","label","rules","required","message","placeholder","value","EMetadataType","page","event","mode","list","map","key","name","onUpdateMetadata","doUpdateMetadata","console","defaultValue","initialValue","code","type","operatorType","EOperatorType","h5","native","all","url","description","handleSubmit","onSubmit","confirm","Modal","onDelTag","doDelTag","onAddTag","doAddTag","onUpdateTag","doUpdateTag","addTagVisible","setAddTagVisible","editTagVisible","setEditTagVisible","curTagInfo","setCurTagInfo","columns","dataIndex","render","text","record","size","onClick","handleUpdateMetadata","handleDeleteMetadata","tagId","content","okText","okType","cancelText","className","style","wrapper","btnBox","rowKey","pagination","dataSource","prefixSelector","Search","addonBefore","metadataList","metadataListParams","uploading","tagListFilters","tagListFiltersSelector","onGetMetadataList","doGetMetadataList","onDeleteMetadata","doDeleteMetadata","onEnableMetadata","doEnableMetadata","onDisableMetadata","doDisableMetadata","onUpdateMetadataLog","doUpdateMetadataLog","onAddMetadataByExcel","doAddMetadataByExcel","addMetadataVisible","setAddMetadataVisible","editMetadataVisible","setEditMetadataVisible","setselectedRowKeys","logByApp","recentLog","curMetadataInfo","setCurMetadataInfo","tagDrawerVisible","setTagDrawerVisible","handleMenuClick","metadataId","menu","sorter","width","sortDirections","dayjs","format","filters","filterMultiple","filterMetadataType","color","overlay","rowSelection","onChange","selectedRowKeys","selectedRows","handleBatch","MetadataAddModal","MetadataEditModal","placement","closable","showUploadList","display","action","config","baseURL","info","file","path","response","result","loading","href","download","current","pageSize","sortKey","sortType","field","order","join","total","totalCount"],"mappings":"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","file":"static/js/17.acd4d95a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"MetadataList_wrapper__6f7Dg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"TagManagement_wrapper__13Kz3\",\"btnBox\":\"TagManagement_btnBox__z6WLz\"};","import { Modal, Form, Input, Select, Button } from 'antd';\nimport * as React from 'react';\nimport { formItemLayout } from '@/constants';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { IMetadataAddParam, ITagList, EMetadataType } from '@/api';\nimport { toastformError } from '@/utils';\nimport { connect } from 'react-redux';\nimport { IAction, IStoreState } from '@/types';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doAddMetadata } from '@/store/actions';\n\ninterface Props extends FormComponentProps {\n  visible: boolean;\n  onClose: (param: boolean) => any;\n  projectId: number;\n  tagList: ITagList;\n  onAddMetadata: (param: IMetadataAddParam) => IAction;\n}\n\nconst MetadataAddModel = (props: Props) => {\n  const { getFieldDecorator } = props.form;\n  const { Option } = Select;\n  const { TextArea } = Input;\n  React.useEffect(() => {\n    props.form.resetFields();\n  }, [props.visible]);\n\n  const handleSubmit = (e: React.MouseEvent) => {\n    e.preventDefault();\n    props.form.validateFields((err, values) => {\n      if (err) {\n        toastformError(err);\n        return;\n      }\n      if (values.newTags) {\n        const newTagsTemp: string[] = [];\n        if (!values.tags) {\n          values.tags = [];\n        }\n        values.newTags.forEach((item: string) => {\n          if (/^\\+?[1-9][0-9]*$/g.test(item)) {\n            values.tags.push(parseInt(item));\n          } else {\n            newTagsTemp.push(item);\n          }\n        });\n        values.newTags = newTagsTemp;\n      }\n      props.onAddMetadata({ projectId: props.projectId, status: 0, log: 0, ...values });\n      props.onClose(false);\n    });\n  };\n\n  return (\n    <Modal onOk={handleSubmit} title='新增元数据' visible={props.visible} onCancel={() => props.onClose(false)}>\n      <Form layout='horizontal' {...formItemLayout}>\n        <Form.Item label='事件名称'>\n          {getFieldDecorator('name', { rules: [{ required: true, message: '请输入事件名称' }] })(\n            <Input placeholder='请输入事件名称' />\n          )}\n        </Form.Item>\n        <Form.Item label='事件code'>\n          {getFieldDecorator('code', {\n            rules: [{ required: true, message: '请输入事件code' }]\n          })(<Input placeholder='请输入事件code' />)}\n        </Form.Item>\n        <Form.Item label='事件类型'>\n          {getFieldDecorator('type', { rules: [{ required: true, message: '请选择事件类型' }] })(\n            <Select placeholder='请选择事件类型'>\n              <Option value={EMetadataType.page}>页面</Option>\n              <Option value={EMetadataType.event}>事件</Option>\n            </Select>\n          )}\n        </Form.Item>\n        <Form.Item label='标签'>\n          {getFieldDecorator(\n            'newTags',\n            {}\n          )(\n            <Select mode='tags' placeholder='选择或添加事件标签'>\n              {props.tagList.list.map((item) => (\n                <Option key={item.id} value={'' + item.id}>\n                  {item.name}\n                </Option>\n              ))}\n            </Select>\n          )}\n        </Form.Item>\n        <Form.Item label='事件备注'>\n          {getFieldDecorator('description', {})(<TextArea placeholder='请输入事件备注' />)}\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const projectId = state.project.projectInfo.id;\n  const tagList = state.metadata.tagList;\n  return {\n    projectId,\n    tagList\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onAddMetadata: (params: IMetadataAddParam) => {\n        return doAddMetadata.request(params);\n      }\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create<Props>()(MetadataAddModel));\n","import { Modal, Form, Input, Select } from 'antd';\nimport * as React from 'react';\nimport { formItemLayout } from '@/constants';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { IMetadataUpdateParam, ITagList, IMetadataInfo, EMetadataType, EOperatorType } from '@/api';\nimport { toastformError } from '@/utils';\nimport { connect } from 'react-redux';\nimport { IAction, IStoreState } from '@/types';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { doUpdateMetadata } from '@/store/actions';\n\ninterface Props extends FormComponentProps {\n  visible: boolean;\n  onClose: (param: boolean) => any;\n  projectId: number;\n  tagList: ITagList;\n  defaultValue: IMetadataInfo;\n  onUpdateMetadata: (param: IMetadataUpdateParam) => IAction;\n}\n\nconst MetadataEditModel = (props: Props) => {\n  const { getFieldDecorator } = props.form;\n  const { Option } = Select;\n  const { TextArea } = Input;\n  React.useEffect(() => {\n    props.form.resetFields();\n  }, [props.visible]);\n  const handleSubmit = (e: React.MouseEvent) => {\n    e.preventDefault();\n    props.form.validateFields((err, values) => {\n      console.log('values', values);\n      if (err) {\n        toastformError(err);\n        return;\n      }\n      if (values.newTags) {\n        const newTagsTemp: string[] = [];\n        if (!values.tags) {\n          values.tags = [];\n        }\n        values.newTags.forEach((item: string) => {\n          if (/^\\+?[1-9][0-9]*$/g.test(item)) {\n            values.tags.push(parseInt(item));\n          } else {\n            newTagsTemp.push(item);\n          }\n        });\n        values.newTags = newTagsTemp;\n      }\n      props.onUpdateMetadata({ ...props.defaultValue, ...values });\n      props.onClose(false);\n    });\n  };\n  return (\n    <Modal onOk={handleSubmit} title='新增元数据' visible={props.visible} onCancel={() => props.onClose(false)}>\n      <Form layout='horizontal' {...formItemLayout}>\n        <Form.Item label='事件名称'>\n          {getFieldDecorator('name', {\n            initialValue: props.defaultValue.name,\n            rules: [{ required: true, message: '请输入事件名称' }]\n          })(<Input placeholder='请输入事件名称' />)}\n        </Form.Item>\n        <Form.Item label='事件code'>\n          {getFieldDecorator('code', {\n            initialValue: props.defaultValue.code,\n            rules: [{ required: true, message: '请输入事件code' }]\n          })(<Input placeholder='请输入事件code' />)}\n        </Form.Item>\n\n        <Form.Item label='事件类型'>\n          {getFieldDecorator('type', {\n            initialValue: props.defaultValue.type,\n            rules: [{ required: true, message: '请选择事件类型' }]\n          })(\n            <Select placeholder='请选择事件类型'>\n              <Option value={EMetadataType.page}>页面</Option>\n              <Option value={EMetadataType.event}>事件</Option>\n            </Select>\n          )}\n        </Form.Item>\n        <Form.Item label='执行者'>\n          {getFieldDecorator('operatorType', {\n            initialValue: props.defaultValue.operatorType\n          })(\n            <Select placeholder='请选择执行者类型'>\n              <Option value={EOperatorType.h5}>h5</Option>\n              <Option value={EOperatorType.native}>native</Option>\n              <Option value={EOperatorType.all}>all</Option>\n              <Option value={EOperatorType['待定']}>待定</Option>\n            </Select>\n          )}\n        </Form.Item>\n        <Form.Item label='标签'>\n          {getFieldDecorator('newTags', {\n            initialValue: props.defaultValue.tags.map((item) => '' + item.id)\n          })(\n            <Select mode='tags' placeholder='选择事件标签'>\n              {props.tagList.list.map((item) => (\n                <Option key={item.id} value={'' + item.id}>\n                  {item.name}\n                </Option>\n              ))}\n            </Select>\n          )}\n        </Form.Item>\n        <Form.Item label='URL'>\n          {getFieldDecorator('url', {\n            initialValue: props.defaultValue.url\n          })(<TextArea placeholder='请输入埋点所在页面地址' />)}\n        </Form.Item>\n        <Form.Item label='事件备注'>\n          {getFieldDecorator('description', {\n            initialValue: props.defaultValue.description\n          })(<TextArea placeholder='请输入事件备注' />)}\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n\nconst mapStateToProps = (state: IStoreState) => {\n  const projectId = state.project.projectInfo.id;\n  const tagList = state.metadata.tagList;\n  return {\n    projectId,\n    tagList\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onUpdateMetadata: (params: IMetadataUpdateParam) => {\n        return doUpdateMetadata.request(params);\n      }\n    },\n    dispatch\n  );\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create<Props>()(MetadataEditModel));\n","import { Form, Input, Modal } from 'antd';\nimport * as React from 'react';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { ITagAddParam } from '@/api';\nimport { toastformError } from '@/utils';\nimport { formItemLayout } from '@/constants';\nconst { TextArea } = Input;\ninterface Props extends FormComponentProps {\n  visible: boolean;\n  onSubmit: (param: ITagAddParam) => any;\n  onClose: (param: boolean) => any;\n}\n\nconst TagAddModal = (props: Props) => {\n  const { getFieldDecorator } = props.form;\n\n  const handleSubmit = () => {\n    props.form.validateFields((err, values) => {\n      if (err) {\n        toastformError(err);\n        return;\n      }\n      props.onSubmit(values);\n      props.onClose(false);\n    });\n  };\n  return (\n    <Modal title='新增标签' visible={props.visible} onOk={handleSubmit} onCancel={() => props.onClose(false)}>\n      <Form onSubmit={handleSubmit} {...formItemLayout}>\n        <Form.Item label='名称'>\n          {getFieldDecorator('name', {\n            initialValue: ''\n          })(<Input placeholder='名称' />)}\n        </Form.Item>\n        <Form.Item label='描述'>\n          {getFieldDecorator('description', {\n            initialValue: ''\n          })(<TextArea placeholder='description' />)}\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n\nexport default Form.create<Props>()(TagAddModal);\n","import { Form, Input, Modal } from 'antd';\nimport * as React from 'react';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { ITagUpdateParam, ITagInfo } from '@/api';\nimport { toastformError } from '@/utils';\nimport { formItemLayout } from '@/constants';\nconst { TextArea } = Input;\ninterface Props extends FormComponentProps {\n  visible: boolean;\n  onSubmit: (param: ITagUpdateParam) => any;\n  onClose: (param: boolean) => any;\n  defaultValue: ITagInfo;\n}\n\nconst TagEditModal = (props: Props) => {\n  const { getFieldDecorator } = props.form;\n\n  const handleSubmit = () => {\n    props.form.validateFields((err, values) => {\n      if (err) {\n        toastformError(err);\n        return;\n      }\n      props.onSubmit({ ...props.defaultValue, ...values });\n      props.onClose(false);\n    });\n  };\n  return (\n    <Modal title='编辑标签' visible={props.visible} onOk={handleSubmit} onCancel={() => props.onClose(false)}>\n      <Form onSubmit={handleSubmit} {...formItemLayout}>\n        <Form.Item label='名称'>\n          {getFieldDecorator('name', {\n            initialValue: props.defaultValue.name\n          })(<Input placeholder='名称' />)}\n        </Form.Item>\n        <Form.Item label='描述'>\n          {getFieldDecorator('description', {\n            initialValue: props.defaultValue.description\n          })(<TextArea placeholder='description' />)}\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n\nexport default Form.create<Props>()(TagEditModal);\n","import * as React from 'react';\nimport style from './TagManagement.module.less';\nimport { connect } from 'react-redux';\nimport { IStoreState, IAction, IDeleteParam } from '@/types';\n\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { Table, Button, Modal } from 'antd';\nimport { ColumnProps } from 'antd/lib/table';\nimport TagAddModal from './TagAddModal';\nimport { doDelTag, doUpdateTag, doAddTag } from '@/store/actions';\nimport { ITagAddParam, ITagUpdateParam, ITagList, ITagInfo } from '@/api';\nimport TagEditModal from './TagEditModal';\n\nconst { confirm } = Modal;\n\ninterface Props {\n  onDelTag: (params: number) => IAction;\n  onAddTag: (params: ITagAddParam) => IAction;\n  onUpdateTag: (params: ITagUpdateParam) => IAction;\n  projectId: number;\n  tagList: ITagList;\n}\n\nconst TagManagement = (props: Props) => {\n  const [addTagVisible, setAddTagVisible] = React.useState(false);\n  const [editTagVisible, setEditTagVisible] = React.useState(false);\n  const [curTagInfo, setCurTagInfo] = React.useState<ITagInfo>({\n    id: null,\n    name: '',\n    description: '',\n    projectId: null\n  });\n  const columns: ColumnProps<any>[] = [\n    {\n      key: 'name',\n      title: '名称',\n      dataIndex: 'name'\n    },\n    {\n      key: 'description',\n      title: '描述',\n      dataIndex: 'description'\n    },\n    {\n      title: '操作',\n      key: 'action',\n      render: (text: any, record: any) => (\n        <span>\n          <Button type='link' size='small' onClick={() => handleUpdateMetadata(record)}>\n            编辑\n          </Button>\n          <Button type='link' size='small' onClick={() => handleDeleteMetadata(record.id)}>\n            删除\n          </Button>\n        </span>\n      )\n    }\n  ];\n\n  const handleUpdateMetadata = (record: ITagInfo) => {\n    setCurTagInfo(record);\n    setEditTagVisible(true);\n  };\n\n  const handleDeleteMetadata = (tagId: number) => {\n    confirm({\n      title: '提示',\n      content: '确定要删除选中的标签',\n      okText: '删除',\n      okType: 'danger',\n      cancelText: '取消',\n      onOk() {\n        props.onDelTag(tagId);\n      }\n    });\n  };\n\n  return (\n    <div className={style.wrapper}>\n      <TagAddModal\n        visible={addTagVisible}\n        onClose={setAddTagVisible}\n        onSubmit={values => props.onAddTag({ projectId: props.projectId, ...values })}\n      ></TagAddModal>\n      <TagEditModal\n        defaultValue={curTagInfo}\n        visible={editTagVisible}\n        onClose={setEditTagVisible}\n        onSubmit={props.onUpdateTag}\n      ></TagEditModal>\n      <div className={style.btnBox}>\n        <Button onClick={() => setAddTagVisible(true)}>新增标签</Button>\n      </div>\n      <Table rowKey='id' pagination={false} columns={columns} dataSource={props.tagList.list} />\n    </div>\n  );\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onDelTag: (params: number) => doDelTag.request(params),\n      onAddTag: (params: ITagAddParam) => doAddTag.request(params),\n      onUpdateTag: (params: ITagUpdateParam) => doUpdateTag.request(params)\n    },\n    dispatch\n  );\n\nconst mapStateToProps = (state: IStoreState) => {\n  const projectId = state.project.projectInfo.id;\n  const tagList = state.metadata.tagList;\n  return {\n    projectId,\n    tagList\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TagManagement);\n","import { Form, Input, Button, Select } from 'antd';\nimport * as React from 'react';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { IMetadataListParam } from '@/api';\nimport { toastformError } from '@/utils';\ninterface Props extends FormComponentProps {\n  onSubmit: (param: IMetadataListParam) => any;\n  defaultValue: IMetadataListParam;\n}\n\nconst MetadataListForm = (props: Props) => {\n  const { getFieldDecorator } = props.form;\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    props.form.validateFields((err, values) => {\n      if (err) {\n        toastformError(err);\n        return;\n      }\n      props.onSubmit({ ...props.defaultValue, code: '', name: '', [values.type]: values.name });\n    });\n  };\n\n  const prefixSelector = getFieldDecorator('type', {\n    initialValue: 'name'\n  })(\n    <Select size='large'>\n      <Select.Option value='name'>名称</Select.Option>\n      <Select.Option value='code'>Code</Select.Option>\n    </Select>\n  );\n\n  return (\n    <Form onSubmit={handleSubmit} layout='inline'>\n      <Form.Item>\n        {getFieldDecorator('name', {\n          initialValue: props.defaultValue.name\n        })(<Input.Search size='large' addonBefore={prefixSelector} placeholder='搜索' />)}\n      </Form.Item>\n    </Form>\n  );\n};\n\nexport default Form.create<Props>()(MetadataListForm);\n","import * as React from 'react';\nimport style from './MetadataList.module.less';\nimport { connect } from 'react-redux';\nimport { IStoreState, IAction, IPageData, IInfoParam } from '@/types';\nimport {\n  doGetMetadataList,\n  doDeleteMetadata,\n  doEnableMetadata,\n  doDisableMetadata,\n  doAddMetadataByExcel,\n  doUpdateMetadataLog\n} from '@/store/actions';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { Table, Button, Modal, Drawer, Tag, Upload, Icon, Avatar, Alert, Dropdown, Menu } from 'antd';\nimport { PaginationConfig, SorterResult, ColumnProps, ColumnFilterItem, TableRowSelection } from 'antd/lib/table';\nimport {\n  IMetadataListParam,\n  IMetadataInfo,\n  ITagInfo,\n  EMetadataType,\n  fetchMetadataAddByExcel,\n  IMetadataAddByExcelParam,\n  EOperatorType\n} from '@/api';\nimport MetadataAddModal from './components/MetadataAddModal';\nimport MetadataEditModal from './components/MetadataEditModal';\nimport TagManagement from './components/TagManagement';\nimport MetadataListForm from './components/MetadataListForm';\nimport { tagListFiltersSelector } from '@/store/selectors';\nimport { UploadChangeParam } from 'antd/lib/upload';\nimport { UploadFile } from 'antd/lib/upload/interface';\nimport config from '@/config';\nimport dayjs from 'dayjs';\nimport { Link } from 'react-router-dom';\nconst { confirm } = Modal;\n\ninterface Props {\n  onGetMetadataList: (params: IMetadataListParam) => IAction;\n  onDeleteMetadata: (params: number) => IAction;\n  onEnableMetadata: (params: number) => IAction;\n  onDisableMetadata: (params: number) => IAction;\n  onAddMetadataByExcel: (params: IMetadataAddByExcelParam) => IAction;\n  onUpdateMetadataLog: (params: IInfoParam) => IAction;\n  metadataList: IPageData<IMetadataInfo>;\n  metadataListParams: IMetadataListParam;\n  tagListFilters: ColumnFilterItem[];\n  projectId: number;\n  uploading: boolean;\n}\n\nconst MetadataList = ({\n  metadataList,\n  onGetMetadataList,\n  onDeleteMetadata,\n  onEnableMetadata,\n  onDisableMetadata,\n  onUpdateMetadataLog,\n  metadataListParams,\n  tagListFilters,\n  onAddMetadataByExcel,\n  projectId,\n  uploading\n}: Props) => {\n  const [addMetadataVisible, setAddMetadataVisible] = React.useState(false);\n  const [editMetadataVisible, setEditMetadataVisible] = React.useState(false);\n  const [selectedRowKeys, setselectedRowKeys] = React.useState([]);\n  const [curMetadataInfo, setCurMetadataInfo] = React.useState<IMetadataInfo>({\n    id: null,\n    code: '',\n    name: '',\n    type: null,\n    description: '',\n    projectId: null,\n    status: null,\n    tags: [],\n    log: 0,\n    logByApp: 0,\n    operatorType: 0,\n    recentLog: 0\n  });\n  const [tagDrawerVisible, setTagDrawerVisible] = React.useState(false);\n\n  const filterMetadataType = (type: number) => {\n    switch (type) {\n      case EMetadataType.page:\n        return '页面';\n      case EMetadataType.event:\n        return '事件';\n      default:\n        return '';\n    }\n  };\n\n  function handleChange(\n    pagination: PaginationConfig,\n    filters: Record<string | number | symbol, string[]>,\n    sorter: SorterResult<any>\n  ) {\n    const params: any = {\n      page: pagination.current,\n      pageSize: pagination.pageSize,\n      sortKey: null,\n      sortType: null,\n      tags: null,\n      type: null,\n      status: null\n    };\n    if (sorter.field) {\n      params.sortKey = sorter.field;\n      params.sortType = sorter.order;\n    }\n    if (filters.tags) {\n      params.tags = filters.tags.join(',');\n    }\n    if (filters.status) {\n      params.status = filters.status[0];\n    }\n    if (filters.type) {\n      params.type = filters.type[0];\n    }\n    if (filters.operatorType) {\n      params.operatorType = filters.operatorType[0];\n    }\n    if (filters.log) {\n      params.log = filters.log[0];\n    }\n\n    onGetMetadataList({ ...metadataListParams, ...params });\n  }\n\n  const handleDeleteMetadata = (metadataId: number) => {\n    confirm({\n      title: '提示',\n      content: '确定要删除选中的元数据',\n      okText: '删除',\n      okType: 'danger',\n      cancelText: '取消',\n      onOk() {\n        onDeleteMetadata(metadataId);\n      }\n    });\n  };\n\n  const handleUpdateMetadata = (record: IMetadataInfo) => {\n    setCurMetadataInfo(record);\n    setEditMetadataVisible(true);\n  };\n\n  const handleImportChange = (info: UploadChangeParam<UploadFile<any>>) => {\n    if (info.file.status === 'done') {\n      onAddMetadataByExcel({ path: info.file.response.result.path, projectId });\n    }\n  };\n\n  const handleMenuClick = (key: string, record: any) => {\n    switch (key) {\n      case 'ENABLE':\n        onEnableMetadata(record.id);\n        break;\n\n      case 'DISABLE':\n        onDisableMetadata(record.id);\n        break;\n      case 'DEL':\n        handleDeleteMetadata(record.id);\n        break;\n\n      case 'UPDATE_LOG':\n        onUpdateMetadataLog({ id: record.id, projectId: record.projectId });\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const menu = (record: any) => (\n    <Menu onClick={({ key }) => handleMenuClick(key, record)}>\n      {record.status === 0 ? <Menu.Item key='ENABLE'>启用</Menu.Item> : <Menu.Item key='DISABLE'>禁用</Menu.Item>}\n      <Menu.Item key='UPDATE_LOG'>更新日志</Menu.Item>\n      <Menu.Item key='DEL'>删除</Menu.Item>\n    </Menu>\n  );\n\n  const columns: ColumnProps<IMetadataInfo>[] = [\n    {\n      key: 'createdAt',\n      title: '创建时间',\n      dataIndex: 'createdAt',\n      sorter: true,\n      width: 120,\n      sortDirections: ['descend', 'ascend'],\n      render: (text: string) => dayjs(text).format('YYYY-MM-DD')\n    },\n    {\n      key: 'name',\n      title: '名称',\n      width: 100,\n      dataIndex: 'name'\n    },\n    {\n      key: 'code',\n      title: 'Code',\n      width: 120,\n      dataIndex: 'code',\n      sorter: true,\n      sortDirections: ['descend', 'ascend']\n    },\n    {\n      key: 'type',\n      title: '类型',\n      dataIndex: 'type',\n      filters: [\n        {\n          text: '页面',\n          value: '' + EMetadataType.page\n        },\n        {\n          text: '事件',\n          value: '' + EMetadataType.event\n        }\n      ],\n      filterMultiple: false,\n      render: (text: number) => <span>{filterMetadataType(text)}</span>\n    },\n    {\n      key: 'operatorType',\n      title: '执行者',\n      dataIndex: 'operatorType',\n      filters: [\n        {\n          text: 'native',\n          value: '' + EOperatorType.native\n        },\n        {\n          text: 'h5',\n          value: '' + EOperatorType.h5\n        },\n        {\n          text: 'all',\n          value: '' + EOperatorType.all\n        },\n        {\n          text: '待定',\n          value: '' + EOperatorType['待定']\n        }\n      ],\n      filterMultiple: false,\n      render: (text: number) => <span>{EOperatorType[text]}</span>\n    },\n    {\n      key: 'status',\n      title: '启用',\n      dataIndex: 'status',\n      filters: [\n        {\n          text: '是',\n          value: '1'\n        },\n        {\n          text: '否',\n          value: '0'\n        }\n      ],\n      filterMultiple: false,\n      render: (text: number) => <span>{text === 1 ? '是' : '否'}</span>\n    },\n    {\n      key: 'log',\n      title: '产生日志',\n      dataIndex: 'log',\n      filters: [\n        {\n          text: '无日志',\n          value: 'NONE'\n        },\n        {\n          text: '无H5日志',\n          value: 'NONE_H5'\n        },\n        {\n          text: '无Native日志',\n          value: 'NONE_NATIVE'\n        },\n        {\n          text: '有H5日志',\n          value: 'H5'\n        },\n        {\n          text: '有Native日志',\n          value: 'NATIVE'\n        },\n        {\n          text: '有日志',\n          value: 'ALL'\n        }\n      ],\n      filterMultiple: false,\n      render: (text: number, record) =>\n        record.log ? (\n          <div>\n            <span>\n              总日志:{record.log}(最新:{record.recentLog})条\n            </span>\n\n            <br />\n            <span>app日志:{record.logByApp}条</span>\n            <br />\n            <span>H5日志:{record.log - record.logByApp}条</span>\n          </div>\n        ) : (\n          <span>无</span>\n        )\n    },\n    {\n      key: 'tags',\n      title: '标签',\n      dataIndex: 'tags',\n      filters: tagListFilters,\n      filterMultiple: true,\n      render: (tags: ITagInfo[], record: any) => {\n        return (\n          <div>\n            {tags.map((item) => (\n              <Tag color='#1890ff' key={item.id}>\n                {item.name}\n              </Tag>\n            ))}\n          </div>\n        );\n      }\n    },\n    {\n      key: 'url',\n      title: 'URL',\n      width: 100,\n      dataIndex: 'url'\n    },\n    {\n      key: 'description',\n      title: '备注',\n      width: 150,\n      dataIndex: 'description'\n    },\n    {\n      title: '操作',\n      key: 'action',\n      width: 120,\n      render: (text: any, record: any) => (\n        <span>\n          <Button type='link' size='small' onClick={() => handleUpdateMetadata(record)}>\n            编辑\n          </Button>\n          &nbsp;\n          <Dropdown overlay={menu(record)}>\n            <span>\n              更多\n              <Icon type='down' />\n            </span>\n          </Dropdown>\n        </span>\n      )\n    }\n  ];\n\n  const rowSelection: TableRowSelection<IMetadataInfo> = {\n    onChange: (selectedRowKeys, selectedRows) => {\n      setselectedRowKeys(selectedRowKeys);\n    }\n  };\n\n  const handleBatch = (type: string) => {\n    switch (type) {\n      case 'TAG':\n        break;\n\n      default:\n        break;\n    }\n  };\n  return (\n    <div className={style.wrapper}>\n      <MetadataAddModal visible={addMetadataVisible} onClose={setAddMetadataVisible}></MetadataAddModal>\n      <MetadataEditModal\n        defaultValue={curMetadataInfo}\n        visible={editMetadataVisible}\n        onClose={setEditMetadataVisible}\n      ></MetadataEditModal>\n      <Drawer\n        width={640}\n        title='标签管理'\n        placement='right'\n        closable={false}\n        onClose={() => setTagDrawerVisible(false)}\n        visible={tagDrawerVisible}\n      >\n        <TagManagement></TagManagement>\n      </Drawer>\n\n      <div className='app-tablePage-wrapper'>\n        <Alert\n          message='请使用命名空间+语义化的方式命名code 如:  业务-类型-详情  zyjk-click-member-pay(智云健康会员支付点击事件)  '\n          type='warning'\n          closable\n        />\n        <div className='app-tablePage-title'>元数据列表</div>\n        <div className='app-tablePage-form'>\n          <div>\n            <Upload\n              showUploadList={false}\n              style={{ display: 'inline-block' }}\n              action={config.baseURL + '/common/upload'}\n              onChange={handleImportChange}\n            >\n              <Button size='large' loading={uploading}>\n                <Icon type='upload' /> 导入元数据\n              </Button>\n            </Upload>\n            &nbsp;\n            <a href='/元数据模板.xlsx' download='导入模板'>\n              <Button size='large'>导入模板下载</Button>\n            </a>\n            &nbsp;\n            <Button size='large' onClick={() => setAddMetadataVisible(true)}>\n              新增元数据\n            </Button>\n            &nbsp;\n            <Button size='large' onClick={() => setTagDrawerVisible(true)}>\n              标签管理\n            </Button>\n          </div>\n          <div>\n            <MetadataListForm defaultValue={metadataListParams} onSubmit={onGetMetadataList}></MetadataListForm>\n          </div>\n        </div>\n\n        <div className='app-tablePage-table'>\n          <div className='app-tablePage-tableBtnBox'>\n            <Button onClick={() => handleBatch('TAG')} type='link'>\n              添加标签\n            </Button>\n            <Button onClick={() => handleBatch('DEL')} type='link'>\n              删除\n            </Button>\n            <Button onClick={() => handleBatch('ENABLE')} type='link'>\n              启用\n            </Button>\n            <Button onClick={() => handleBatch('DISABLE')} type='link'>\n              禁用\n            </Button>\n          </div>\n\n          <Table\n            rowSelection={rowSelection}\n            rowKey='id'\n            columns={columns}\n            dataSource={metadataList.list}\n            onChange={handleChange}\n            pagination={{ pageSize: 20, total: metadataList.totalCount }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<IAction>) =>\n  bindActionCreators(\n    {\n      onGetMetadataList: (params) => {\n        return doGetMetadataList.request(params);\n      },\n      onDeleteMetadata: (params) => {\n        return doDeleteMetadata.request(params);\n      },\n      onEnableMetadata: (params) => {\n        return doEnableMetadata.request(params);\n      },\n      onDisableMetadata: (params) => {\n        return doDisableMetadata.request(params);\n      },\n      onUpdateMetadataLog: (params) => {\n        return doUpdateMetadataLog.request(params);\n      },\n      onAddMetadataByExcel: (params) => {\n        return doAddMetadataByExcel.request(params);\n      }\n    },\n    dispatch\n  );\n\nconst mapStateToProps = (state: IStoreState) => {\n  const { metadataList, metadataListParams, tagList, uploading } = state.metadata;\n  const projectId = state.project.projectInfo.id;\n  const tagListFilters = tagListFiltersSelector(state);\n  return {\n    metadataList,\n    metadataListParams,\n    tagList,\n    tagListFilters,\n    projectId,\n    uploading\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MetadataList);\n"],"sourceRoot":""}